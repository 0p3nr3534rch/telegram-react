(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{409:function(e,t,a){"use strict";var n=a(7),r=a(10),c=a(12),o=a(11),l=a(13),i=a(0),s=a.n(i),u=a(53),p=a(391),d=a(69),h=(a(422),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(l)))).onFastUpdatingComplete=function(e){a.forceUpdate()},a.onUpdateChatTitle=function(e){var t=a.props.chatId;e.chat_id===t&&a.forceUpdate()},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.chatId!==this.props.chatId||e.t!==this.props.t}},{key:"componentDidMount",value:function(){d.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),d.a.on("updateChatTitle",this.onUpdateChatTitle)}},{key:"componentWillUnmount",value:function(){d.a.removeListener("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),d.a.removeListener("updateChatTitle",this.onUpdateChatTitle)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.showSavedMessages,r=Object(p.q)(a,n,t);return s.a.createElement("div",{className:"dialog-title"},r)}}]),t}(s.a.Component));h.defaultProps={showSavedMessages:!0},t.a=Object(u.c)()(h)},415:function(e,t,a){"use strict";var n=a(7),r=a(10),c=a(12),o=a(11),l=a(13),i=a(0),s=a.n(i),u=a(404),p=a(409),d=a(8),h=a.n(d),m=a(6),f=a.n(m),v=a(391),b=a(69),C=a(45),I=a(408),g=a(401),y=(a(423),function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(c.a)(this,Object(o.a)(t).call(this,e))).onUpdateUserStatus=function(e){var t=a.props.chatId,n=b.a.get(t);if(n&&n.type){var r=!1;switch(n.type["@type"]){case"chatTypeBasicGroup":var c=I.a.getFullInfo(n.type.basic_group_id);if(c&&c.members)c.members.find(function(t){return t.user_id===e.user_id})&&(r=!0);break;case"chatTypePrivate":case"chatTypeSecret":n.type.user_id===e.user_id&&(r=!0)}r&&a.updateSubtitle(n)}},a.updateSubtitle=function(e){a.setState({subtitle:Object(v.p)(e.id),isAccent:Object(v.K)(e.id)})},a.onUpdateUserFullInfo=function(e){var t=a.props.chatId,n=b.a.get(t);n&&(!n.type||"chatTypePrivate"!==n.type["@type"]&&"chatTypeSecret"!==n.type["@type"]||n.type.user_id!==e.user_id||a.updateSubtitle(n))},a.onUpdateBasicGroupFullInfo=function(e){var t=a.props.chatId,n=b.a.get(t);n&&n.type&&"chatTypeBasicGroup"===n.type["@type"]&&n.type.basic_group_id===e.basic_group_id&&a.updateSubtitle(n)},a.onUpdateSupergroupFullInfo=function(e){var t=a.props.chatId,n=b.a.get(t);n&&n.type&&"chatTypeSupergroup"===n.type["@type"]&&n.type.supergroup_id===e.supergroup_id&&a.updateSubtitle(n)},a.onUpdateBasicGroup=function(e){var t=a.props.chatId,n=b.a.get(t);n&&n.type&&"chatTypeBasicGroup"===n.type["@type"]&&n.type.basic_group_id===e.basic_group.id&&a.updateSubtitle(n)},a.onUpdateSupergroup=function(e){var t=a.props.chatId,n=b.a.get(t);n&&n.type&&"chatTypeSupergroup"===n.type["@type"]&&n.type.supergroup_id===e.supergroup.id&&a.updateSubtitle(n)};var r=a.props.chatId;return a.state={prevChatId:r,subtitle:Object(v.p)(r),isAccent:Object(v.K)(r)},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.chatId,n=this.state,r=n.subtitle,c=n.isAccent;return e.chatId!==a||(t.subtitle!==r||t.isAccent!==c)}},{key:"componentDidMount",value:function(){C.a.on("updateUserStatus",this.onUpdateUserStatus),I.a.on("updateBasicGroup",this.onUpdateBasicGroup),g.a.on("updateSupergroup",this.onUpdateSupergroup),C.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),I.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),g.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"componentWillUnmount",value:function(){C.a.removeListener("updateUserStatus",this.onUpdateUserStatus),I.a.removeListener("updateBasicGroup",this.onUpdateBasicGroup),g.a.removeListener("updateSupergroup",this.onUpdateSupergroup),C.a.removeListener("updateUserFullInfo",this.onUpdateUserFullInfo),I.a.removeListener("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),g.a.removeListener("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.subtitle,n=t.isAccent;return s.a.createElement("div",{className:h()("dialog-status",n?e.statusAccentSubtitle:e.statusSubtitle)},a)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.chatId!==t.prevChatId){var a=e.chatId;return{prevChatId:a,subtitle:Object(v.p)(a),isAccent:Object(v.K)(a)}}return null}}]),t}(s.a.Component)),O=f()(function(e){return{statusSubtitle:{color:"dark"===e.palette.type?e.palette.text.secondary:"#70777b"},statusAccentSubtitle:{color:e.palette.primary.dark+"!important"}}},{withTheme:!0})(y),E=(a(424),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(c.a)(this,Object(o.a)(t).call(this,e))).handleClick=function(){var e=a.props,t=e.chatId,n=e.onSelect;if(n){var r=b.a.get(t);r&&n(r)}},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.chatId!==this.props.chatId}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.onTileSelect,n=e.showStatus,r=e.showSavedMessages;return s.a.createElement("div",{className:"chat",onClick:this.handleClick},s.a.createElement("div",{className:"chat-wrapper"},s.a.createElement(u.a,{chatId:t,onSelect:a,showSavedMessages:r}),s.a.createElement("div",{className:"dialog-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement(p.a,{chatId:t,showSavedMessages:r})),n&&!r&&s.a.createElement("div",{className:"tile-second-row"},s.a.createElement(O,{chatId:t})))))}}]),t}(s.a.Component));E.defaultProps={showSavedMessages:!0,showStatus:!0};t.a=E},421:function(e,t,a){"use strict";var n=a(7),r=a(10),c=a(12),o=a(11),l=a(13),i=a(0),s=a.n(i),u=a(488),p=a(413),d=a.n(p),h=(a(457),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(c.a)(this,Object(o.a)(t).call(this,e))).handleTimer=function(){var e=new Date,t=a.expire-e,n=100-t/a.props.timeout*100;a.setState({seconds:t>0?t:0,value:n>100?100:n}),e>=a.expire&&a.timerId&&(clearInterval(a.timerId),a.timerId=null)},a.state={seconds:a.props.timeout/1e3,value:0},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.startTime=new Date,this.expire=this.startTime,this.expire.setMilliseconds(this.expire.getMilliseconds()+this.props.timeout),this.timerId=setInterval(this.handleTimer,100)}},{key:"componentWillUnmount",value:function(){this.timerId&&(clearInterval(this.timerId),this.timerId=null)}},{key:"render",value:function(){var e=this.state,t=e.value,a=e.seconds;return s.a.createElement("div",{className:"notification-timer"},s.a.createElement("div",{className:"notification-timer-text"},s.a.createElement(u.a,{color:"inherit"},(a/1e3).toFixed())),s.a.createElement("div",{className:"notification-timer-progress"},s.a.createElement(d.a,{size:32,value:100-t,variant:"static"})))}}]),t}(s.a.Component));t.a=h},422:function(e,t,a){},423:function(e,t,a){},424:function(e,t,a){},438:function(e,t,a){"use strict";var n=a(14),r=a.n(n),c=a(24),o=a(134),l=a(7),i=a(10),s=a(12),u=a(11),p=a(13),d=a(0),h=a.n(d),m=a(120),f=a.n(m),v=a(459),b=a.n(v),C=a(414),I=a.n(C),g=a(411),y=a.n(g),O=a(32),E=a.n(O),j=a(79),S=a.n(j),k=a(78),U=a.n(k),w=a(82),N=a.n(w),_=a(80),x=a.n(_),F=a(81),T=a.n(F),D=a(6),M=a.n(D),B=a(125),G=a(77),H=a(404),L=a(421),A=a(391),P=a(27),W=a(16),R=a(69),z=a(401),V=a(2),q=(a(458),{vertical:"bottom",horizontal:"right"}),K={vertical:"top",horizontal:"right"},J=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getDeleteDialogText=function(e){var t=R.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return"Are you sure you want to leave group ".concat(t.title,"?");case"chatTypeSupergroup":var a=z.a.get(t.type.supergroup_id);return a?a.is_channel?"Are you sure you want to leave channel ".concat(t.title,"?"):"Are you sure you want to leave group ".concat(t.title,"?"):null;case"chatTypePrivate":case"chatTypeSecret":return"Are you sure you want to delete chat with ".concat(Object(A.n)(e),"?")}return null},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.chatId,n=Object(o.a)(e,["onClose","chatId"]);return h.a.createElement(U.a,Object.assign({transitionDuration:0,onClose:function(){return t(!1)},"aria-labelledby":"delete-dialog-title"},n),h.a.createElement(S.a,{id:"delete-dialog-title"},Object(A.n)(a)),h.a.createElement(x.a,null,h.a.createElement("div",{className:"delete-dialog-content"},h.a.createElement(H.a,{chatId:a}),h.a.createElement(N.a,{id:"delete-dialog-description"},this.getDeleteDialogText(a)))),h.a.createElement(T.a,null,h.a.createElement(E.a,{onClick:function(){return t(!1)},color:"primary"},"Cancel"),h.a.createElement(E.a,{onClick:function(){return t(!0)},color:"primary",autoFocus:!0},"Ok")))}}]),t}(h.a.Component),Q=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.chatId,n=Object(o.a)(e,["onClose","chatId"]);return h.a.createElement(U.a,Object.assign({transitionDuration:0,onClose:function(){return t(!1)},"aria-labelledby":"delete-dialog-title"},n),h.a.createElement(S.a,{id:"delete-dialog-title"},Object(A.n)(a)),h.a.createElement(x.a,null,h.a.createElement("div",{className:"delete-dialog-content"},h.a.createElement(H.a,{chatId:a}),h.a.createElement(N.a,{id:"delete-dialog-description"},"Are you sure you want clear history?"))),h.a.createElement(T.a,null,h.a.createElement(E.a,{onClick:function(){return t(!1)},color:"primary"},"Cancel"),h.a.createElement(E.a,{onClick:function(){return t(!0)},color:"primary",autoFocus:!0},"Ok")))}}]),t}(h.a.Component),X=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleButtonClick=function(e){a.setState({anchorEl:e.currentTarget})},a.handleMenuClose=function(){a.setState({anchorEl:null})},a.handleChatInfo=function(){a.handleMenuClose(),setTimeout(function(){return a.props.openChatDetails()},150)},a.handleClearHistory=function(){a.handleMenuClose(),a.setState({openClearHistory:!0})},a.handleClearHistoryContinue=function(e){if(a.setState({openClearHistory:!1}),e){var t=W.a.getChatId(),n={"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!1};a.handleScheduledAction(t,"clientUpdateClearHistory","Messages deleted",n)}},a.handleLeave=function(){a.handleMenuClose(),a.setState({openDelete:!0})},a.handleLeaveContinue=function(e){if(a.setState({openDelete:!1}),e){var t=W.a.getChatId(),n=a.getLeaveChatNotification(t),r=Object(A.Q)(t)?{"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!0}:{"@type":"leaveChat",chat_id:t};a.handleScheduledAction(t,"clientUpdateLeaveChat",n,r)}},a.handleScheduledAction=function(e,t,n,o){if(t){var l="".concat(t," chatId=").concat(e),i=function(){var a=Object(c.a)(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,V.a.send(o);case 3:return a.prev=3,V.a.clientUpdate({"@type":t,chatId:e,inProgress:!1}),a.finish(3);case 6:case"end":return a.stop()}},a,null,[[0,,3,6]])}));return function(){return a.apply(this,arguments)}}(),s=a.props,u=s.enqueueSnackbar;s.classes;if(u){W.a.addScheduledAction(l,P.p,i,function(){V.a.clientUpdate({"@type":t,chatId:e,inProgress:!1})})&&(V.a.clientUpdate({"@type":t,chatId:e,inProgress:!0}),u(n,{autoHideDuration:P.p-300,action:[h.a.createElement(f.a,{key:"progress",color:"inherit",className:"progress-button"},h.a.createElement(L.a,{timeout:P.p})),h.a.createElement(E.a,{key:"undo",color:"primary",size:"small",onClick:function(){return W.a.removeScheduledAction(l)}},"UNDO")]}))}}},a.getLeaveChatTitle=function(e){var t=R.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return"Delete and exit";case"chatTypeSupergroup":var a=z.a.get(t.type.supergroup_id);return a?a.is_channel?"Leave channel":"Leave group":null;case"chatTypePrivate":case"chatTypeSecret":return"Delete conversation"}return null},a.getLeaveChatNotification=function(e){var t=R.a.get(e);if(!t)return"Chat deleted";if(!t.type)return"Chat deleted";switch(t.type["@type"]){case"chatTypeBasicGroup":return"Chat deleted";case"chatTypeSupergroup":var a=z.a.get(t.type.supergroup_id);return a?a.is_channel?"Left channel":"Left group":"Chat deleted";case"chatTypePrivate":case"chatTypeSecret":return"Chat deleted"}return"Chat deleted"},a.state={anchorEl:null,openDelete:!1,openClearHistory:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.anchorEl,n=t.openDelete,r=t.openClearHistory,c=W.a.getChatId(),o=Object(A.a)(c),l=Object(A.b)(c),i=this.getLeaveChatTitle(c);return h.a.createElement(h.a.Fragment,null,h.a.createElement(f.a,{"aria-owns":a?"simple-menu":null,"aria-haspopup":"true",className:e.menuIconButton,"aria-label":"Menu",onClick:this.handleButtonClick},h.a.createElement(b.a,null)),h.a.createElement(I.a,{id:"main-menu",anchorEl:a,open:Boolean(a),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:q,transformOrigin:K},h.a.createElement(y.a,{onClick:this.handleChatInfo},"Chat info"),o&&h.a.createElement(y.a,{onClick:this.handleClearHistory},"Clear history"),l&&i&&h.a.createElement(y.a,{onClick:this.handleLeave},i)),h.a.createElement(J,{chatId:c,open:n,onClose:this.handleLeaveContinue}),h.a.createElement(Q,{chatId:c,open:r,onClose:this.handleClearHistoryContinue}))}}]),t}(h.a.Component),Y=Object(G.a)(M()(function(e){return{menuIconButton:{margin:"8px 12px 8px 0"}}}),B.withSnackbar);t.a=Y(X)},457:function(e,t,a){},458:function(e,t,a){},460:function(e,t,a){},461:function(e,t,a){},462:function(e,t,a){},463:function(e,t,a){},464:function(e,t,a){},465:function(e,t,a){},466:function(e,t,a){},467:function(e,t,a){},468:function(e,t,a){},513:function(e,t,a){"use strict";a.r(t);var n=a(14),r=a.n(n),c=a(24),o=a(7),l=a(10),i=a(12),s=a(11),u=a(13),p=a(0),d=a.n(p),h=a(8),m=a.n(h),f=a(6),v=a.n(f),b=a(418),C=a.n(b),I=a(77),g=a(125),y=a(53),O=a(453),E=a.n(O),j=a(506),S=a.n(j),k=a(507),U=a.n(k),w=a(508),N=a.n(w),_=a(402),x=a.n(_),F=a(120),T=a.n(F),D=a(400),M=a.n(D),B=a(406),G=a.n(B),H=a(405),L=a.n(H),A=a(420),P=a.n(A),W=a(184),R=a.n(W),z=a(46),V=a.n(z),q=(a(438),a(421),a(416)),K=a(396),J=a(399),Q=a(45),X=(a(460),function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onUpdateUserStatus=function(e){var t=a.props.userId,n=Q.a.get(t);t===e.user_id&&a.setState({status:Object(J.f)(n),isAccent:Object(J.i)(n)})};var n=a.props.userId,r=Q.a.get(n);return a.state={prevUserId:n,status:Object(J.f)(r),isAccent:Object(J.i)(r)},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.userId,r=a.theme,c=this.state,o=c.status,l=c.isAccent;return e.theme!==r||(e.userId!==n||(t.status!==o||t.isAccent!==l))}},{key:"componentDidMount",value:function(){Q.a.on("updateUserStatus",this.onUpdateUserStatus)}},{key:"componentWillUnmount",value:function(){Q.a.removeListener("updateUserStatus",this.onUpdateUserStatus)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.status,n=t.isAccent;return d.a.createElement("div",{className:m()("dialog-content",e.userStatusSubtitle,Object(K.a)({"accent-color":n},e.userStatusAccentSubtitle,n))},a)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.userId!==t.prevUserId){var a=e.userId,n=Q.a.get(a);return{prevUserId:a,status:Object(J.f)(n),isAccent:Object(J.i)(n)}}return null}}]),t}(d.a.Component)),Y=v()(function(e){return{userStatusSubtitle:{color:"dark"===e.palette.type?e.palette.text.secondary:"#70777b"},userStatusAccentSubtitle:{color:e.palette.primary.dark+"!important"}}},{withTheme:!0})(X),Z=(a(461),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){var e=a.props,t=e.userId,n=e.onSelect,r=Q.a.get(t);r&&n&&n(r)},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.userId!==this.props.userId}},{key:"render",value:function(){var e=this.props.userId,t=Q.a.get(e),a=Object(J.c)(t);return d.a.createElement("div",{className:"user",onClick:this.handleClick},d.a.createElement("div",{className:"user-wrapper"},d.a.createElement(q.a,{userId:e}),d.a.createElement("div",{className:"dialog-inner-wrapper"},d.a.createElement("div",{className:"tile-first-row"},d.a.createElement("div",{className:"dialog-title"},a)),d.a.createElement("div",{className:"tile-second-row"},d.a.createElement(Y,{userId:e})))))}}]),t}(d.a.Component)),$=a(415),ee=a(417),te=a.n(ee),ae=(a(462),a(391)),ne=function(e){function t(e){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).call(this,e))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.chatId,n=e.t,r=e.backButton,c=e.onClick,o=e.onClose,l=n("ChatInfo");return Object(ae.Q)(a)?l=n("Info"):Object(ae.L)(a)&&(l=n("ChannelInfo")),d.a.createElement("div",{className:"header-master"},r&&d.a.createElement(T.a,{className:t.leftIconButton,onClick:o},d.a.createElement(te.a,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:c},d.a.createElement("span",{className:"header-status-content"},l)),!r&&d.a.createElement(T.a,{className:t.rightIconButton,onClick:o},d.a.createElement(x.a,null)))}}]),t}(d.a.Component),re=Object(I.a)(Object(y.c)(),v()({leftIconButton:{margin:"8px -2px 8px 12px"},rightIconButton:{margin:"8px 12px 8px -2px"}},{withTheme:!0}))(ne),ce=a(439),oe=a.n(ce),le=a(502),ie=a.n(le),se=a(501),ue=a.n(se),pe=a(440),de=a.n(pe),he=function(e){function t(e){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).call(this,e))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.t,n=this.state.isMuted;return d.a.createElement(M.a,{button:!0,className:t.listItem,onClick:this.handleSetChatNotifications},d.a.createElement(G.a,null,n?d.a.createElement(ie.a,null):d.a.createElement(ue.a,null)),d.a.createElement(L.a,{primary:d.a.createElement(V.a,{variant:"inherit",noWrap:!0},a("Notifications"))}),d.a.createElement(oe.a,null,d.a.createElement(de.a,{color:"primary",onChange:this.handleSetChatNotifications,checked:!n})))}}]),t}(a(455).a),me=Object(I.a)(Object(y.c)(),v()({listItem:{padding:"11px 22px"}},{withTheme:!0}))(he),fe=a(503),ve=a.n(fe),be=a(504),Ce=a.n(be),Ie=a(505),ge=a.n(Ie),ye=a(441),Oe=a.n(ye),Ee=a(69),je=a(2),Se=a(16),ke=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleMoreClick=function(){a.setState({openMore:!a.state.openMore})},a.handleSendMessage=function(){var e=Se.a.getChatId(),t=a.props.chatId;e===t||je.a.setChatId(t)},a.handleBlock=function(){var e=a.state.chatId,t=Ee.a.get(e);if(t&&t.type){var n=t.type.user_id;n&&je.a.send({"@type":Object(J.h)(n)?"unblockUser":"blockUser",user_id:n})}};var n=a.props.chatId;return a.state={prevChatId:n,openMore:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.classes,r=this.state.openMore,c=Ee.a.get(a),o=Object(ae.O)(a),l=!1;!o&&c.type&&(l=Object(J.h)(c.type.user_id));var i=Object(ae.M)(a),s=Object(ae.L)(a);return d.a.createElement(d.a.Fragment,null,d.a.createElement(M.a,{button:!0,className:n.listItem,onClick:this.handleMoreClick},d.a.createElement(G.a,null,d.a.createElement(ve.a,null)),d.a.createElement(L.a,{primary:d.a.createElement(V.a,{variant:"inherit",noWrap:!0},t("More"))}),r?d.a.createElement(Ce.a,null):d.a.createElement(ge.a,null)),d.a.createElement(Oe.a,{in:r,timeout:"auto",unmountOnExit:!0},d.a.createElement(R.a,{component:"div",disablePadding:!0},!o&&d.a.createElement(d.a.Fragment,null,d.a.createElement(M.a,{button:!0,className:n.listItem,onClick:this.handleSendMessage},d.a.createElement(L.a,{inset:!0,primary:d.a.createElement(V.a,{variant:"inherit",noWrap:!0},t("SendMessage"))})),d.a.createElement(M.a,{button:!0,className:n.listItem,onClick:this.handleBlock},d.a.createElement(L.a,{inset:!0,primary:d.a.createElement(V.a,{color:"secondary",variant:"inherit",noWrap:!0},t(l?"Unblock":"BlockContact"))}))),o&&i&&d.a.createElement(M.a,{button:!0,className:n.listItem},d.a.createElement(L.a,{inset:!0,primary:d.a.createElement(V.a,{color:"secondary",variant:"inherit",noWrap:!0},t(s?"LeaveChannel":"DeleteChat"))})),o&&!i&&d.a.createElement(M.a,{button:!0,className:n.listItem},d.a.createElement(L.a,{inset:!0,primary:d.a.createElement(V.a,{color:"secondary",variant:"inherit",noWrap:!0},t("ReportChat"))})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId,openMore:!1}:null}}]),t}(d.a.Component),Ue=Object(I.a)(Object(y.c)(),v()({listItem:{padding:"11px 22px"}},{withTheme:!0}))(ke),we=a(393),Ne=a(30),_e=a(121),xe=a(54),Fe=a(27),Te=a(408),De=a(401),Me=a(60),Be=a(392),Ge=(a(463),function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onUpdateBasicGroupFullInfo=function(e){var t=Ee.a.get(a.props.chatId);t&&t.type&&"chatTypeBasicGroup"===t.type["@type"]&&t.type.basic_group_id===e.basic_group_id&&(a.handleSelectChat(),a.forceUpdate())},a.onUpdateSupergroupFullInfo=function(e){var t=Ee.a.get(a.props.chatId);t&&t.type&&"chatTypeSupergroup"===t.type["@type"]&&t.type.supergroup_id===e.supergroup_id&&a.forceUpdate()},a.onUpdateUserFullInfo=function(e){var t=Ee.a.get(a.props.chatId);t&&(!t.type||"chatTypePrivate"!==t.type["@type"]&&"chatTypeSecret"!==t.type["@type"]||t.type.user_id!==e.user_id||a.forceUpdate())},a.onUpdateUserStatus=function(e){a.members.has(e.user_id)&&a.forceUpdate()},a.handleSelectChat=function(){a.getFullInfo(),a.getGroupsInCommon(),a.loadChatContents()},a.loadChatContents=function(){var e=a.props.chatId,t=Be.a.getStore();Object(we.l)(t,[e]);var n=Object(ae.x)(e).map(function(e){return e.user_id});Object(we.t)(t,n)},a.getFullInfo=function(){var e=a.props.chatId;Object(ae.k)(e)},a.getGroupsInCommon=Object(c.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.chatId,!Object(ae.O)(t)){e.next=4;break}return e.abrupt("return");case 4:if(!Object(ae.P)(t)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,je.a.send({"@type":"getGroupsInCommon",user_id:Object(ae.v)(t),offset_chat_id:0,limit:1});case 9:n=e.sent,a.setState({hasGroupsInCommon:n.chat_ids.length>0});case 11:case"end":return e.stop()}},e)})),a.handleUsernameHint=function(){var e=a.props,t=e.t,n=e.chatId,r=Object(ae.w)(n);if(r){var c=Me.a.get("t_me_url"),o=c?c.value:"https://telegram.org/";C()(o+r);var l="".concat(n,"_copy_username"),i=t("TextCopied");a.handleScheduledAction(l,i,null)}},a.handleScheduledAction=function(e,t,n){if(e){var r=a.props,c=r.enqueueSnackbar,o=r.classes;if(c){Se.a.addScheduledAction(e,Fe.p+300,n)&&c(t,{autoHideDuration:Fe.p,action:[d.a.createElement(T.a,{key:"close","aria-label":"Close",color:"inherit",className:o.close,onClick:function(){return Se.a.removeScheduledAction(e)}},d.a.createElement(x.a,null))]})}}},a.handlePhoneHint=function(){var e=a.props,t=e.t,n=e.chatId,r=Object(ae.m)(n);if(r){C()(Object(Ne.d)(r));var c="".concat(n,"_copy_phone"),o=t("PhoneCopied");a.handleScheduledAction(c,o,null)}},a.handleHeaderClick=function(){a.chatDetailsListRef.current.scrollTop=0},a.handleOpenViewer=function(){var e=a.props.chatId,t=Ee.a.get(e);t&&t.photo&&Se.a.setProfileMediaViewerContent({chatId:e})},a.handleOpenChat=function(){var e=a.props,t=e.chatId,n=e.popup;Object(_e.b)(t,null,!1),n&&je.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},a.getContentHeight=function(){return a.chatDetailsListRef?a.chatDetailsListRef.current.clientHeight:0},a.chatDetailsListRef=d.a.createRef();var n=a.props.chatId;return a.members=new Map,a.state={prevChatId:n,hasGroupsInCommon:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getSnapshotBeforeUpdate",value:function(e,t){var a=this.props.chatId,n=this.chatDetailsListRef.current,r=n.scrollTop,c=n.scrollHeight,o=n.offsetHeight,l={scrollTop:r,scrollHeight:c,offsetHeight:o};return console.log("[ChatDetails] getSnapshotBeforeUpdate chatId=".concat(a," scrollTop=").concat(r," scrollHeight=").concat(c," offsetHeight=").concat(o)),l}},{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.theme,c=this.state.hasGroupsInCommon;return e.chatId!==n||(e.theme!==r||t.hasGroupsInCommon!==c)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.chatId;e.chatId!==n&&this.handleSelectChat(),console.log("chatDetailsListRef",this.chatDetailsListRef);var r=this.chatDetailsListRef.current,c=a.scrollTop,o=a.scrollHeight;a.offsetHeight;console.log("[ChatDetails] componentDidUpdate before chatId=".concat(n," list.scrollTop=").concat(r.scrollTop," list.offsetHeight=").concat(r.offsetHeight," list.scrollHeight=").concat(r.scrollHeight)),r.scrollTop=c+(r.scrollHeight-o),console.log("[ChatDetails] componentDidUpdate after chatId=".concat(n," list.scrollTop=").concat(r.scrollTop," list.offsetHeight=").concat(r.offsetHeight," list.scrollHeight=").concat(r.scrollHeight))}},{key:"componentDidMount",value:function(){this.handleSelectChat(),Q.a.on("updateUserStatus",this.onUpdateUserStatus),Q.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),Te.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),De.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"componentWillUnmount",value:function(){Q.a.removeListener("updateUserStatus",this.onUpdateUserStatus),Q.a.removeListener("updateUserFullInfo",this.onUpdateUserFullInfo),Te.a.removeListener("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),De.a.removeListener("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.className,r=t.chatId,c=t.classes,o=t.onOpenSharedMedia,l=t.onOpenGroupsInCommon,i=t.popup,s=t.backButton,u=t.onClose,p=this.state.hasGroupsInCommon,h=Ee.a.get(r);if(!h)return d.a.createElement("div",{className:"chat-details"},d.a.createElement(re,{onClose:u}),d.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"}));var f=Object(ae.w)(r),v=Object(ae.m)(r),b=Object(ae.h)(r),C=Object(ae.O)(r),I=Object(ae.P)(r),g=Object(ae.x)(r),y=[];this.members=new Map,g.forEach(function(t){var a=Q.a.get(t.user_id);a&&(e.members.set(a.id,a.id),y.push(a))});var O=y.sort(function(e,t){return Object(J.g)(t)-Object(J.g)(e)}).map(function(t){return d.a.createElement(M.a,{button:!0,className:c.listItem,key:t.id},d.a.createElement(Z,{userId:t.id,onSelect:e.handleSelectUser}))}),j=h.photo,k=d.a.createElement(d.a.Fragment,null,d.a.createElement(re,{chatId:r,backButton:s,onClose:u,onClick:this.handleHeaderClick}),d.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"},d.a.createElement("div",{className:"chat-details-info"},d.a.createElement($.a,{chatId:r,showStatus:i,showSavedMessages:!i,onTileSelect:j?this.handleOpenViewer:null})),(f||v||b)&&d.a.createElement(R.a,null,f&&d.a.createElement(M.a,{button:!0,className:c.listItem,onClick:this.handleUsernameHint},d.a.createElement(G.a,null,d.a.createElement(S.a,null)),d.a.createElement(L.a,{primary:d.a.createElement(V.a,{variant:"inherit",noWrap:!0},f)})),v&&d.a.createElement(d.a.Fragment,null,d.a.createElement(M.a,{button:!0,className:c.listItem,onClick:this.handlePhoneHint},d.a.createElement(G.a,null,d.a.createElement(U.a,null)),d.a.createElement(L.a,{primary:d.a.createElement(V.a,{variant:"inherit",noWrap:!0},Object(Ne.d)(v))}))),b&&d.a.createElement(M.a,{className:c.listItem},d.a.createElement(G.a,null,d.a.createElement(N.a,{className:"chat-details-info-icon"})),d.a.createElement(L.a,{primary:b,style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}}))),d.a.createElement(P.a,null),d.a.createElement(R.a,null,!I&&d.a.createElement(me,{chatId:r}),C&&d.a.createElement(Ue,{chatId:r}),!C&&d.a.createElement(M.a,{button:!0,className:c.listItem,onClick:this.handleOpenChat},d.a.createElement(L.a,{inset:!0,primary:d.a.createElement(V.a,{color:"primary",variant:"inherit",noWrap:!0},a("SendMessage").toUpperCase())}))),d.a.createElement(P.a,null),d.a.createElement(R.a,null,d.a.createElement(M.a,{button:!0,disabled:!0,className:c.listItem,onClick:o},d.a.createElement(G.a,null,d.a.createElement(E.a,null)),d.a.createElement(L.a,{primary:d.a.createElement(V.a,{variant:"inherit",noWrap:!0},a("SharedMedia"))})),p&&d.a.createElement(M.a,{button:!0,className:c.listItem,onClick:l},d.a.createElement(L.a,{inset:!0,primary:d.a.createElement(V.a,{variant:"inherit",noWrap:!0},a("GroupsInCommon"))}))),O.length>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement(P.a,null),d.a.createElement(R.a,null,O))));return i?d.a.createElement(d.a.Fragment,null,k):d.a.createElement("div",{className:m()("chat-details",n)},k)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId,hasGroupsInCommon:!1}:null}}]),t}(d.a.Component)),He=Object(I.a)(Object(xe.c)(),Object(y.c)(),v()(function(e){return{closeIconButton:{margin:"8px -2px 8px 12px"},nested:{},close:{padding:e.spacing.unit/2},listItem:{padding:"11px 22px"}}},{withTheme:!0}),g.withSnackbar,Object(xe.b)())(Ge),Le=(a(464),function(e){function t(e){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).call(this,e))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.onClose;return d.a.createElement("div",{className:"header-master"},d.a.createElement(T.a,{className:t.backIconButton,onClick:a},d.a.createElement(te.a,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},"Groups in common")))}}]),t}(d.a.Component)),Ae=v()({backIconButton:{margin:"8px -2px 8px 12px"}})(Le),Pe=(a(465),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleSelect=function(e){var t=a.props.popup;Object(_e.b)(e.id),t&&je.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},a.state={chatIds:[]},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.chatId,a=Object(ae.v)(t);a&&je.a.send({"@type":"getGroupsInCommon",user_id:a,offset_chat_id:0,limit:100}).then(function(t){var a=Be.a.getStore();Object(we.l)(a,t.chat_ids),e.setState({chatIds:t.chat_ids})})}},{key:"render",value:function(){var e=this,t=this.props,a=t.minHeight,n=t.onClose,r=t.popup,c=this.state.chatIds.map(function(t){return d.a.createElement(M.a,{button:!0,key:t},d.a.createElement($.a,{chatId:t,onSelect:e.handleSelect}))}),o=d.a.createElement(d.a.Fragment,null,d.a.createElement(Ae,{onClose:n}),d.a.createElement("div",{className:"groups-in-common-list",style:{minHeight:a}},c));return r?d.a.createElement(d.a.Fragment,null,o):d.a.createElement("div",{className:"groups-in-common"},o)}}]),t}(d.a.Component));Pe.defaultProps={popup:!1,minHeight:0};var We=Pe,Re=a(442),ze=a.n(Re),Ve=a(443),qe=a.n(Ve),Ke=(a(466),function(e){function t(e){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).call(this,e))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.close;return d.a.createElement("div",{className:"header-master"},d.a.createElement(T.a,{className:t.backIconButton,onClick:a},d.a.createElement(te.a,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},"Shared Media")))}}]),t}(d.a.Component)),Je=v()({backIconButton:{margin:"8px -2px 8px 12px"}})(Ke),Qe=(a(467),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={value:0},a.handleChange=function(e,t){a.setState({value:t})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.popup,n=this.state.value,r=d.a.createElement(d.a.Fragment,null,d.a.createElement(Je,{close:t}),d.a.createElement(ze.a,{value:n,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",scrollable:!0,scrollButtons:"off",fullWidth:!0},d.a.createElement(qe.a,{label:"Media",style:{minWidth:"40px"}}),d.a.createElement(qe.a,{label:"Docs",style:{minWidth:"40px"}}),d.a.createElement(qe.a,{label:"Links",style:{minWidth:"40px"}}),d.a.createElement(qe.a,{label:"Audio",style:{minWidth:"40px"}})));return a?d.a.createElement(d.a.Fragment,null,r):d.a.createElement("div",{className:"shared-media"},r)}}]),t}(d.a.Component));Qe.defaultProps={popup:!1,minHeight:0};var Xe=Qe,Ye=a(398),Ze=(a(468),function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateChatId=function(e){a.props.popup||a.setState({chatId:e.nextChatId,userChatId:null,openSharedMedia:!1,openGroupsInCommon:!1})},a.handelOpenSharedMedia=function(){a.setState({openSharedMedia:!0})},a.handleCloseSharedMedia=function(){a.setState({openSharedMedia:!1})},a.handleOpenGroupsInCommon=function(e){console.log("ChatInfo.handleOpenGroupsInCommon",e),a.setState({openGroupsInCommon:!0})},a.handleCloseGroupsInCommon=function(){a.setState({openGroupsInCommon:!1})},a.handleCloseChatDetails=function(){var e=a.props.popup;a.state.userChatId?a.setState({userChatId:null}):e?je.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0}):Se.a.changeChatDetailsVisibility(!1)},a.handleSelectUser=function(){var e=Object(c.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,je.a.send({"@type":"createPrivateChat",user_id:t.id,force:!0});case 4:if(n=e.sent,n=Ee.a.get(n.id)||n){e.next=8;break}return e.abrupt("return");case 8:a.setState({userChatId:n.id});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.detailsRef=d.a.createRef();var n=e.popup;return a.state={chatId:n?Se.a.dialogChatId:Se.a.chatId},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){Se.a.on("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"componentWillUnmount",value:function(){Se.a.removeListener("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.className,n=e.popup,r=this.state,c=r.chatId,o=r.userChatId,l=r.openSharedMedia,i=r.openGroupsInCommon,s=c||o,u=this.detailsRef&&this.detailsRef.current?this.detailsRef.current.getContentHeight():0,p=null;return p=l?d.a.createElement(Xe,{chatId:s,popup:n,minHeight:u,onClose:this.handleCloseSharedMedia}):i?d.a.createElement(We,{chatId:s,popup:n,minHeight:u,onClose:this.handleCloseGroupsInCommon}):d.a.createElement(He,{ref:this.detailsRef,chatId:s,popup:n,backButton:o===c,onOpenSharedMedia:this.handelOpenSharedMedia,onOpenGroupsInCommon:this.handleOpenGroupsInCommon,onClose:this.handleCloseChatDetails}),n?d.a.createElement(d.a.Fragment,null,p):d.a.createElement("div",{className:m()(t.borderColor,{"right-column":!n},a)},p)}}]),t}(d.a.Component));Ze.defaultProps={className:null,classes:null,popup:!1};t.default=v()(Ye.b)(Ze)}}]);
//# sourceMappingURL=8.ef5978ba.chunk.js.map