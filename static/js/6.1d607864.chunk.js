(window.webpackJsonp=window.webpackJsonp||[]).push([[6,8],{409:function(e,t,a){"use strict";var n=a(7),i=a(10),r=a(12),s=a(11),o=a(13),l=a(0),c=a.n(l),d=a(53),u=a(391),p=a(69),h=(a(422),function(e){function t(){var e,a;Object(n.a)(this,t);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).onFastUpdatingComplete=function(e){a.forceUpdate()},a.onUpdateChatTitle=function(e){var t=a.props.chatId;e.chat_id===t&&a.forceUpdate()},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.chatId!==this.props.chatId||e.t!==this.props.t}},{key:"componentDidMount",value:function(){p.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),p.a.on("updateChatTitle",this.onUpdateChatTitle)}},{key:"componentWillUnmount",value:function(){p.a.removeListener("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),p.a.removeListener("updateChatTitle",this.onUpdateChatTitle)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.showSavedMessages,i=Object(u.q)(a,n,t);return c.a.createElement("div",{className:"dialog-title"},i)}}]),t}(c.a.Component));h.defaultProps={showSavedMessages:!0},t.a=Object(d.c)()(h)},415:function(e,t,a){"use strict";var n=a(7),i=a(10),r=a(12),s=a(11),o=a(13),l=a(0),c=a.n(l),d=a(404),u=a(409),p=a(8),h=a.n(p),m=a(6),g=a.n(m),f=a(391),v=a(69),b=a(45),y=a(408),C=a(401),O=(a(423),function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onUpdateUserStatus=function(e){var t=a.props.chatId,n=v.a.get(t);if(n&&n.type){var i=!1;switch(n.type["@type"]){case"chatTypeBasicGroup":var r=y.a.getFullInfo(n.type.basic_group_id);if(r&&r.members)r.members.find(function(t){return t.user_id===e.user_id})&&(i=!0);break;case"chatTypePrivate":case"chatTypeSecret":n.type.user_id===e.user_id&&(i=!0)}i&&a.updateSubtitle(n)}},a.updateSubtitle=function(e){a.setState({subtitle:Object(f.p)(e.id),isAccent:Object(f.K)(e.id)})},a.onUpdateUserFullInfo=function(e){var t=a.props.chatId,n=v.a.get(t);n&&(!n.type||"chatTypePrivate"!==n.type["@type"]&&"chatTypeSecret"!==n.type["@type"]||n.type.user_id!==e.user_id||a.updateSubtitle(n))},a.onUpdateBasicGroupFullInfo=function(e){var t=a.props.chatId,n=v.a.get(t);n&&n.type&&"chatTypeBasicGroup"===n.type["@type"]&&n.type.basic_group_id===e.basic_group_id&&a.updateSubtitle(n)},a.onUpdateSupergroupFullInfo=function(e){var t=a.props.chatId,n=v.a.get(t);n&&n.type&&"chatTypeSupergroup"===n.type["@type"]&&n.type.supergroup_id===e.supergroup_id&&a.updateSubtitle(n)},a.onUpdateBasicGroup=function(e){var t=a.props.chatId,n=v.a.get(t);n&&n.type&&"chatTypeBasicGroup"===n.type["@type"]&&n.type.basic_group_id===e.basic_group.id&&a.updateSubtitle(n)},a.onUpdateSupergroup=function(e){var t=a.props.chatId,n=v.a.get(t);n&&n.type&&"chatTypeSupergroup"===n.type["@type"]&&n.type.supergroup_id===e.supergroup.id&&a.updateSubtitle(n)};var i=a.props.chatId;return a.state={prevChatId:i,subtitle:Object(f.p)(i),isAccent:Object(f.K)(i)},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.chatId,n=this.state,i=n.subtitle,r=n.isAccent;return e.chatId!==a||(t.subtitle!==i||t.isAccent!==r)}},{key:"componentDidMount",value:function(){b.a.on("updateUserStatus",this.onUpdateUserStatus),y.a.on("updateBasicGroup",this.onUpdateBasicGroup),C.a.on("updateSupergroup",this.onUpdateSupergroup),b.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),y.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),C.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"componentWillUnmount",value:function(){b.a.removeListener("updateUserStatus",this.onUpdateUserStatus),y.a.removeListener("updateBasicGroup",this.onUpdateBasicGroup),C.a.removeListener("updateSupergroup",this.onUpdateSupergroup),b.a.removeListener("updateUserFullInfo",this.onUpdateUserFullInfo),y.a.removeListener("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),C.a.removeListener("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.subtitle,n=t.isAccent;return c.a.createElement("div",{className:h()("dialog-status",n?e.statusAccentSubtitle:e.statusSubtitle)},a)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.chatId!==t.prevChatId){var a=e.chatId;return{prevChatId:a,subtitle:Object(f.p)(a),isAccent:Object(f.K)(a)}}return null}}]),t}(c.a.Component)),S=g()(function(e){return{statusSubtitle:{color:"dark"===e.palette.type?e.palette.text.secondary:"#70777b"},statusAccentSubtitle:{color:e.palette.primary.dark+"!important"}}},{withTheme:!0})(O),I=(a(424),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).handleClick=function(){var e=a.props,t=e.chatId,n=e.onSelect;if(n){var i=v.a.get(t);i&&n(i)}},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.chatId!==this.props.chatId}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.onTileSelect,n=e.showStatus,i=e.showSavedMessages;return c.a.createElement("div",{className:"chat",onClick:this.handleClick},c.a.createElement("div",{className:"chat-wrapper"},c.a.createElement(d.a,{chatId:t,onSelect:a,showSavedMessages:i}),c.a.createElement("div",{className:"dialog-inner-wrapper"},c.a.createElement("div",{className:"tile-first-row"},c.a.createElement(u.a,{chatId:t,showSavedMessages:i})),n&&!i&&c.a.createElement("div",{className:"tile-second-row"},c.a.createElement(S,{chatId:t})))))}}]),t}(c.a.Component));I.defaultProps={showSavedMessages:!0,showStatus:!0};t.a=I},421:function(e,t,a){"use strict";var n=a(7),i=a(10),r=a(12),s=a(11),o=a(13),l=a(0),c=a.n(l),d=a(488),u=a(413),p=a.n(u),h=(a(457),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).handleTimer=function(){var e=new Date,t=a.expire-e,n=100-t/a.props.timeout*100;a.setState({seconds:t>0?t:0,value:n>100?100:n}),e>=a.expire&&a.timerId&&(clearInterval(a.timerId),a.timerId=null)},a.state={seconds:a.props.timeout/1e3,value:0},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.startTime=new Date,this.expire=this.startTime,this.expire.setMilliseconds(this.expire.getMilliseconds()+this.props.timeout),this.timerId=setInterval(this.handleTimer,100)}},{key:"componentWillUnmount",value:function(){this.timerId&&(clearInterval(this.timerId),this.timerId=null)}},{key:"render",value:function(){var e=this.state,t=e.value,a=e.seconds;return c.a.createElement("div",{className:"notification-timer"},c.a.createElement("div",{className:"notification-timer-text"},c.a.createElement(d.a,{color:"inherit"},(a/1e3).toFixed())),c.a.createElement("div",{className:"notification-timer-progress"},c.a.createElement(p.a,{size:32,value:100-t,variant:"static"})))}}]),t}(c.a.Component));t.a=h},422:function(e,t,a){},423:function(e,t,a){},424:function(e,t,a){},438:function(e,t,a){"use strict";var n=a(14),i=a.n(n),r=a(24),s=a(134),o=a(7),l=a(10),c=a(12),d=a(11),u=a(13),p=a(0),h=a.n(p),m=a(120),g=a.n(m),f=a(459),v=a.n(f),b=a(414),y=a.n(b),C=a(411),O=a.n(C),S=a(32),I=a.n(S),U=a(79),E=a.n(U),k=a(78),M=a.n(k),j=a(82),_=a.n(j),w=a(80),L=a.n(w),T=a(81),N=a.n(T),R=a(6),D=a.n(R),x=a(125),H=a(77),P=a(404),B=a(421),F=a(391),A=a(27),V=a(16),z=a(69),G=a(401),W=a(2),q=(a(458),{vertical:"bottom",horizontal:"right"}),K={vertical:"top",horizontal:"right"},J=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).getDeleteDialogText=function(e){var t=z.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return"Are you sure you want to leave group ".concat(t.title,"?");case"chatTypeSupergroup":var a=G.a.get(t.type.supergroup_id);return a?a.is_channel?"Are you sure you want to leave channel ".concat(t.title,"?"):"Are you sure you want to leave group ".concat(t.title,"?"):null;case"chatTypePrivate":case"chatTypeSecret":return"Are you sure you want to delete chat with ".concat(Object(F.n)(e),"?")}return null},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.chatId,n=Object(s.a)(e,["onClose","chatId"]);return h.a.createElement(M.a,Object.assign({transitionDuration:0,onClose:function(){return t(!1)},"aria-labelledby":"delete-dialog-title"},n),h.a.createElement(E.a,{id:"delete-dialog-title"},Object(F.n)(a)),h.a.createElement(L.a,null,h.a.createElement("div",{className:"delete-dialog-content"},h.a.createElement(P.a,{chatId:a}),h.a.createElement(_.a,{id:"delete-dialog-description"},this.getDeleteDialogText(a)))),h.a.createElement(N.a,null,h.a.createElement(I.a,{onClick:function(){return t(!1)},color:"primary"},"Cancel"),h.a.createElement(I.a,{onClick:function(){return t(!0)},color:"primary",autoFocus:!0},"Ok")))}}]),t}(h.a.Component),$=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.chatId,n=Object(s.a)(e,["onClose","chatId"]);return h.a.createElement(M.a,Object.assign({transitionDuration:0,onClose:function(){return t(!1)},"aria-labelledby":"delete-dialog-title"},n),h.a.createElement(E.a,{id:"delete-dialog-title"},Object(F.n)(a)),h.a.createElement(L.a,null,h.a.createElement("div",{className:"delete-dialog-content"},h.a.createElement(P.a,{chatId:a}),h.a.createElement(_.a,{id:"delete-dialog-description"},"Are you sure you want clear history?"))),h.a.createElement(N.a,null,h.a.createElement(I.a,{onClick:function(){return t(!1)},color:"primary"},"Cancel"),h.a.createElement(I.a,{onClick:function(){return t(!0)},color:"primary",autoFocus:!0},"Ok")))}}]),t}(h.a.Component),Q=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleButtonClick=function(e){a.setState({anchorEl:e.currentTarget})},a.handleMenuClose=function(){a.setState({anchorEl:null})},a.handleChatInfo=function(){a.handleMenuClose(),setTimeout(function(){return a.props.openChatDetails()},150)},a.handleClearHistory=function(){a.handleMenuClose(),a.setState({openClearHistory:!0})},a.handleClearHistoryContinue=function(e){if(a.setState({openClearHistory:!1}),e){var t=V.a.getChatId(),n={"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!1};a.handleScheduledAction(t,"clientUpdateClearHistory","Messages deleted",n)}},a.handleLeave=function(){a.handleMenuClose(),a.setState({openDelete:!0})},a.handleLeaveContinue=function(e){if(a.setState({openDelete:!1}),e){var t=V.a.getChatId(),n=a.getLeaveChatNotification(t),i=Object(F.Q)(t)?{"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!0}:{"@type":"leaveChat",chat_id:t};a.handleScheduledAction(t,"clientUpdateLeaveChat",n,i)}},a.handleScheduledAction=function(e,t,n,s){if(t){var o="".concat(t," chatId=").concat(e),l=function(){var a=Object(r.a)(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,W.a.send(s);case 3:return a.prev=3,W.a.clientUpdate({"@type":t,chatId:e,inProgress:!1}),a.finish(3);case 6:case"end":return a.stop()}},a,null,[[0,,3,6]])}));return function(){return a.apply(this,arguments)}}(),c=a.props,d=c.enqueueSnackbar;c.classes;if(d){V.a.addScheduledAction(o,A.p,l,function(){W.a.clientUpdate({"@type":t,chatId:e,inProgress:!1})})&&(W.a.clientUpdate({"@type":t,chatId:e,inProgress:!0}),d(n,{autoHideDuration:A.p-300,action:[h.a.createElement(g.a,{key:"progress",color:"inherit",className:"progress-button"},h.a.createElement(B.a,{timeout:A.p})),h.a.createElement(I.a,{key:"undo",color:"primary",size:"small",onClick:function(){return V.a.removeScheduledAction(o)}},"UNDO")]}))}}},a.getLeaveChatTitle=function(e){var t=z.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return"Delete and exit";case"chatTypeSupergroup":var a=G.a.get(t.type.supergroup_id);return a?a.is_channel?"Leave channel":"Leave group":null;case"chatTypePrivate":case"chatTypeSecret":return"Delete conversation"}return null},a.getLeaveChatNotification=function(e){var t=z.a.get(e);if(!t)return"Chat deleted";if(!t.type)return"Chat deleted";switch(t.type["@type"]){case"chatTypeBasicGroup":return"Chat deleted";case"chatTypeSupergroup":var a=G.a.get(t.type.supergroup_id);return a?a.is_channel?"Left channel":"Left group":"Chat deleted";case"chatTypePrivate":case"chatTypeSecret":return"Chat deleted"}return"Chat deleted"},a.state={anchorEl:null,openDelete:!1,openClearHistory:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.anchorEl,n=t.openDelete,i=t.openClearHistory,r=V.a.getChatId(),s=Object(F.a)(r),o=Object(F.b)(r),l=this.getLeaveChatTitle(r);return h.a.createElement(h.a.Fragment,null,h.a.createElement(g.a,{"aria-owns":a?"simple-menu":null,"aria-haspopup":"true",className:e.menuIconButton,"aria-label":"Menu",onClick:this.handleButtonClick},h.a.createElement(v.a,null)),h.a.createElement(y.a,{id:"main-menu",anchorEl:a,open:Boolean(a),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:q,transformOrigin:K},h.a.createElement(O.a,{onClick:this.handleChatInfo},"Chat info"),s&&h.a.createElement(O.a,{onClick:this.handleClearHistory},"Clear history"),o&&l&&h.a.createElement(O.a,{onClick:this.handleLeave},l)),h.a.createElement(J,{chatId:r,open:n,onClose:this.handleLeaveContinue}),h.a.createElement($,{chatId:r,open:i,onClose:this.handleClearHistoryContinue}))}}]),t}(h.a.Component),X=Object(H.a)(D()(function(e){return{menuIconButton:{margin:"8px 12px 8px 0"}}}),x.withSnackbar);t.a=X(Q)},457:function(e,t,a){},458:function(e,t,a){},460:function(e,t,a){},461:function(e,t,a){},462:function(e,t,a){},463:function(e,t,a){},464:function(e,t,a){},465:function(e,t,a){},466:function(e,t,a){},467:function(e,t,a){},468:function(e,t,a){},470:function(e,t,a){},513:function(e,t,a){"use strict";a.r(t);var n=a(14),i=a.n(n),r=a(24),s=a(7),o=a(10),l=a(12),c=a(11),d=a(13),u=a(0),p=a.n(u),h=a(8),m=a.n(h),g=a(6),f=a.n(g),v=a(418),b=a.n(v),y=a(77),C=a(125),O=a(53),S=a(453),I=a.n(S),U=a(506),E=a.n(U),k=a(507),M=a.n(k),j=a(508),_=a.n(j),w=a(402),L=a.n(w),T=a(120),N=a.n(T),R=a(400),D=a.n(R),x=a(406),H=a.n(x),P=a(405),B=a.n(P),F=a(420),A=a.n(F),V=a(184),z=a.n(V),G=a(46),W=a.n(G),q=(a(438),a(421),a(416)),K=a(396),J=a(399),$=a(45),Q=(a(460),function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onUpdateUserStatus=function(e){var t=a.props.userId,n=$.a.get(t);t===e.user_id&&a.setState({status:Object(J.f)(n),isAccent:Object(J.i)(n)})};var n=a.props.userId,i=$.a.get(n);return a.state={prevUserId:n,status:Object(J.f)(i),isAccent:Object(J.i)(i)},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.userId,i=a.theme,r=this.state,s=r.status,o=r.isAccent;return e.theme!==i||(e.userId!==n||(t.status!==s||t.isAccent!==o))}},{key:"componentDidMount",value:function(){$.a.on("updateUserStatus",this.onUpdateUserStatus)}},{key:"componentWillUnmount",value:function(){$.a.removeListener("updateUserStatus",this.onUpdateUserStatus)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.status,n=t.isAccent;return p.a.createElement("div",{className:m()("dialog-content",e.userStatusSubtitle,Object(K.a)({"accent-color":n},e.userStatusAccentSubtitle,n))},a)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.userId!==t.prevUserId){var a=e.userId,n=$.a.get(a);return{prevUserId:a,status:Object(J.f)(n),isAccent:Object(J.i)(n)}}return null}}]),t}(p.a.Component)),X=f()(function(e){return{userStatusSubtitle:{color:"dark"===e.palette.type?e.palette.text.secondary:"#70777b"},userStatusAccentSubtitle:{color:e.palette.primary.dark+"!important"}}},{withTheme:!0})(Q),Y=(a(461),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).handleClick=function(){var e=a.props,t=e.userId,n=e.onSelect,i=$.a.get(t);i&&n&&n(i)},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.userId!==this.props.userId}},{key:"render",value:function(){var e=this.props.userId,t=$.a.get(e),a=Object(J.c)(t);return p.a.createElement("div",{className:"user",onClick:this.handleClick},p.a.createElement("div",{className:"user-wrapper"},p.a.createElement(q.a,{userId:e}),p.a.createElement("div",{className:"dialog-inner-wrapper"},p.a.createElement("div",{className:"tile-first-row"},p.a.createElement("div",{className:"dialog-title"},a)),p.a.createElement("div",{className:"tile-second-row"},p.a.createElement(X,{userId:e})))))}}]),t}(p.a.Component)),Z=a(415),ee=a(417),te=a.n(ee),ae=(a(462),a(391)),ne=function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.chatId,n=e.t,i=e.backButton,r=e.onClick,s=e.onClose,o=n("ChatInfo");return Object(ae.Q)(a)?o=n("Info"):Object(ae.L)(a)&&(o=n("ChannelInfo")),p.a.createElement("div",{className:"header-master"},i&&p.a.createElement(N.a,{className:t.leftIconButton,onClick:s},p.a.createElement(te.a,null)),p.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:r},p.a.createElement("span",{className:"header-status-content"},o)),!i&&p.a.createElement(N.a,{className:t.rightIconButton,onClick:s},p.a.createElement(L.a,null)))}}]),t}(p.a.Component),ie=Object(y.a)(Object(O.c)(),f()({leftIconButton:{margin:"8px -2px 8px 12px"},rightIconButton:{margin:"8px 12px 8px -2px"}},{withTheme:!0}))(ne),re=a(439),se=a.n(re),oe=a(502),le=a.n(oe),ce=a(501),de=a.n(ce),ue=a(440),pe=a.n(ue),he=function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.t,n=this.state.isMuted;return p.a.createElement(D.a,{button:!0,className:t.listItem,onClick:this.handleSetChatNotifications},p.a.createElement(H.a,null,n?p.a.createElement(le.a,null):p.a.createElement(de.a,null)),p.a.createElement(B.a,{primary:p.a.createElement(W.a,{variant:"inherit",noWrap:!0},a("Notifications"))}),p.a.createElement(se.a,null,p.a.createElement(pe.a,{color:"primary",onChange:this.handleSetChatNotifications,checked:!n})))}}]),t}(a(455).a),me=Object(y.a)(Object(O.c)(),f()({listItem:{padding:"11px 22px"}},{withTheme:!0}))(he),ge=a(503),fe=a.n(ge),ve=a(504),be=a.n(ve),ye=a(505),Ce=a.n(ye),Oe=a(441),Se=a.n(Oe),Ie=a(69),Ue=a(2),Ee=a(16),ke=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleMoreClick=function(){a.setState({openMore:!a.state.openMore})},a.handleSendMessage=function(){var e=Ee.a.getChatId(),t=a.props.chatId;e===t||Ue.a.setChatId(t)},a.handleBlock=function(){var e=a.state.chatId,t=Ie.a.get(e);if(t&&t.type){var n=t.type.user_id;n&&Ue.a.send({"@type":Object(J.h)(n)?"unblockUser":"blockUser",user_id:n})}};var n=a.props.chatId;return a.state={prevChatId:n,openMore:!1},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.classes,i=this.state.openMore,r=Ie.a.get(a),s=Object(ae.O)(a),o=!1;!s&&r.type&&(o=Object(J.h)(r.type.user_id));var l=Object(ae.M)(a),c=Object(ae.L)(a);return p.a.createElement(p.a.Fragment,null,p.a.createElement(D.a,{button:!0,className:n.listItem,onClick:this.handleMoreClick},p.a.createElement(H.a,null,p.a.createElement(fe.a,null)),p.a.createElement(B.a,{primary:p.a.createElement(W.a,{variant:"inherit",noWrap:!0},t("More"))}),i?p.a.createElement(be.a,null):p.a.createElement(Ce.a,null)),p.a.createElement(Se.a,{in:i,timeout:"auto",unmountOnExit:!0},p.a.createElement(z.a,{component:"div",disablePadding:!0},!s&&p.a.createElement(p.a.Fragment,null,p.a.createElement(D.a,{button:!0,className:n.listItem,onClick:this.handleSendMessage},p.a.createElement(B.a,{inset:!0,primary:p.a.createElement(W.a,{variant:"inherit",noWrap:!0},t("SendMessage"))})),p.a.createElement(D.a,{button:!0,className:n.listItem,onClick:this.handleBlock},p.a.createElement(B.a,{inset:!0,primary:p.a.createElement(W.a,{color:"secondary",variant:"inherit",noWrap:!0},t(o?"Unblock":"BlockContact"))}))),s&&l&&p.a.createElement(D.a,{button:!0,className:n.listItem},p.a.createElement(B.a,{inset:!0,primary:p.a.createElement(W.a,{color:"secondary",variant:"inherit",noWrap:!0},t(c?"LeaveChannel":"DeleteChat"))})),s&&!l&&p.a.createElement(D.a,{button:!0,className:n.listItem},p.a.createElement(B.a,{inset:!0,primary:p.a.createElement(W.a,{color:"secondary",variant:"inherit",noWrap:!0},t("ReportChat"))})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId,openMore:!1}:null}}]),t}(p.a.Component),Me=Object(y.a)(Object(O.c)(),f()({listItem:{padding:"11px 22px"}},{withTheme:!0}))(ke),je=a(393),_e=a(30),we=a(121),Le=a(54),Te=a(27),Ne=a(408),Re=a(401),De=a(60),xe=a(392),He=(a(463),function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onUpdateBasicGroupFullInfo=function(e){var t=Ie.a.get(a.props.chatId);t&&t.type&&"chatTypeBasicGroup"===t.type["@type"]&&t.type.basic_group_id===e.basic_group_id&&(a.handleSelectChat(),a.forceUpdate())},a.onUpdateSupergroupFullInfo=function(e){var t=Ie.a.get(a.props.chatId);t&&t.type&&"chatTypeSupergroup"===t.type["@type"]&&t.type.supergroup_id===e.supergroup_id&&a.forceUpdate()},a.onUpdateUserFullInfo=function(e){var t=Ie.a.get(a.props.chatId);t&&(!t.type||"chatTypePrivate"!==t.type["@type"]&&"chatTypeSecret"!==t.type["@type"]||t.type.user_id!==e.user_id||a.forceUpdate())},a.onUpdateUserStatus=function(e){a.members.has(e.user_id)&&a.forceUpdate()},a.handleSelectChat=function(){a.getFullInfo(),a.getGroupsInCommon(),a.loadChatContents()},a.loadChatContents=function(){var e=a.props.chatId,t=xe.a.getStore();Object(je.l)(t,[e]);var n=Object(ae.x)(e).map(function(e){return e.user_id});Object(je.t)(t,n)},a.getFullInfo=function(){var e=a.props.chatId;Object(ae.k)(e)},a.getGroupsInCommon=Object(r.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.chatId,!Object(ae.O)(t)){e.next=4;break}return e.abrupt("return");case 4:if(!Object(ae.P)(t)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Ue.a.send({"@type":"getGroupsInCommon",user_id:Object(ae.v)(t),offset_chat_id:0,limit:1});case 9:n=e.sent,a.setState({hasGroupsInCommon:n.chat_ids.length>0});case 11:case"end":return e.stop()}},e)})),a.handleUsernameHint=function(){var e=a.props,t=e.t,n=e.chatId,i=Object(ae.w)(n);if(i){var r=De.a.get("t_me_url"),s=r?r.value:"https://telegram.org/";b()(s+i);var o="".concat(n,"_copy_username"),l=t("TextCopied");a.handleScheduledAction(o,l,null)}},a.handleScheduledAction=function(e,t,n){if(e){var i=a.props,r=i.enqueueSnackbar,s=i.classes;if(r){Ee.a.addScheduledAction(e,Te.p+300,n)&&r(t,{autoHideDuration:Te.p,action:[p.a.createElement(N.a,{key:"close","aria-label":"Close",color:"inherit",className:s.close,onClick:function(){return Ee.a.removeScheduledAction(e)}},p.a.createElement(L.a,null))]})}}},a.handlePhoneHint=function(){var e=a.props,t=e.t,n=e.chatId,i=Object(ae.m)(n);if(i){b()(Object(_e.d)(i));var r="".concat(n,"_copy_phone"),s=t("PhoneCopied");a.handleScheduledAction(r,s,null)}},a.handleHeaderClick=function(){a.chatDetailsListRef.current.scrollTop=0},a.handleOpenViewer=function(){var e=a.props.chatId,t=Ie.a.get(e);t&&t.photo&&Ee.a.setProfileMediaViewerContent({chatId:e})},a.handleOpenChat=function(){var e=a.props,t=e.chatId,n=e.popup;Object(we.b)(t,null,!1),n&&Ue.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},a.getContentHeight=function(){return a.chatDetailsListRef?a.chatDetailsListRef.current.clientHeight:0},a.chatDetailsListRef=p.a.createRef();var n=a.props.chatId;return a.members=new Map,a.state={prevChatId:n,hasGroupsInCommon:!1},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"getSnapshotBeforeUpdate",value:function(e,t){var a=this.props.chatId,n=this.chatDetailsListRef.current,i=n.scrollTop,r=n.scrollHeight,s=n.offsetHeight,o={scrollTop:i,scrollHeight:r,offsetHeight:s};return console.log("[ChatDetails] getSnapshotBeforeUpdate chatId=".concat(a," scrollTop=").concat(i," scrollHeight=").concat(r," offsetHeight=").concat(s)),o}},{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,i=a.theme,r=this.state.hasGroupsInCommon;return e.chatId!==n||(e.theme!==i||t.hasGroupsInCommon!==r)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.chatId;e.chatId!==n&&this.handleSelectChat(),console.log("chatDetailsListRef",this.chatDetailsListRef);var i=this.chatDetailsListRef.current,r=a.scrollTop,s=a.scrollHeight;a.offsetHeight;console.log("[ChatDetails] componentDidUpdate before chatId=".concat(n," list.scrollTop=").concat(i.scrollTop," list.offsetHeight=").concat(i.offsetHeight," list.scrollHeight=").concat(i.scrollHeight)),i.scrollTop=r+(i.scrollHeight-s),console.log("[ChatDetails] componentDidUpdate after chatId=".concat(n," list.scrollTop=").concat(i.scrollTop," list.offsetHeight=").concat(i.offsetHeight," list.scrollHeight=").concat(i.scrollHeight))}},{key:"componentDidMount",value:function(){this.handleSelectChat(),$.a.on("updateUserStatus",this.onUpdateUserStatus),$.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),Ne.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Re.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"componentWillUnmount",value:function(){$.a.removeListener("updateUserStatus",this.onUpdateUserStatus),$.a.removeListener("updateUserFullInfo",this.onUpdateUserFullInfo),Ne.a.removeListener("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Re.a.removeListener("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.className,i=t.chatId,r=t.classes,s=t.onOpenSharedMedia,o=t.onOpenGroupsInCommon,l=t.popup,c=t.backButton,d=t.onClose,u=this.state.hasGroupsInCommon,h=Ie.a.get(i);if(!h)return p.a.createElement("div",{className:"chat-details"},p.a.createElement(ie,{onClose:d}),p.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"}));var g=Object(ae.w)(i),f=Object(ae.m)(i),v=Object(ae.h)(i),b=Object(ae.O)(i),y=Object(ae.P)(i),C=Object(ae.x)(i),O=[];this.members=new Map,C.forEach(function(t){var a=$.a.get(t.user_id);a&&(e.members.set(a.id,a.id),O.push(a))});var S=O.sort(function(e,t){return Object(J.g)(t)-Object(J.g)(e)}).map(function(t){return p.a.createElement(D.a,{button:!0,className:r.listItem,key:t.id},p.a.createElement(Y,{userId:t.id,onSelect:e.handleSelectUser}))}),U=h.photo,k=p.a.createElement(p.a.Fragment,null,p.a.createElement(ie,{chatId:i,backButton:c,onClose:d,onClick:this.handleHeaderClick}),p.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"},p.a.createElement("div",{className:"chat-details-info"},p.a.createElement(Z.a,{chatId:i,showStatus:l,showSavedMessages:!l,onTileSelect:U?this.handleOpenViewer:null})),(g||f||v)&&p.a.createElement(z.a,null,g&&p.a.createElement(D.a,{button:!0,className:r.listItem,onClick:this.handleUsernameHint},p.a.createElement(H.a,null,p.a.createElement(E.a,null)),p.a.createElement(B.a,{primary:p.a.createElement(W.a,{variant:"inherit",noWrap:!0},g)})),f&&p.a.createElement(p.a.Fragment,null,p.a.createElement(D.a,{button:!0,className:r.listItem,onClick:this.handlePhoneHint},p.a.createElement(H.a,null,p.a.createElement(M.a,null)),p.a.createElement(B.a,{primary:p.a.createElement(W.a,{variant:"inherit",noWrap:!0},Object(_e.d)(f))}))),v&&p.a.createElement(D.a,{className:r.listItem},p.a.createElement(H.a,null,p.a.createElement(_.a,{className:"chat-details-info-icon"})),p.a.createElement(B.a,{primary:v,style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}}))),p.a.createElement(A.a,null),p.a.createElement(z.a,null,!y&&p.a.createElement(me,{chatId:i}),b&&p.a.createElement(Me,{chatId:i}),!b&&p.a.createElement(D.a,{button:!0,className:r.listItem,onClick:this.handleOpenChat},p.a.createElement(B.a,{inset:!0,primary:p.a.createElement(W.a,{color:"primary",variant:"inherit",noWrap:!0},a("SendMessage").toUpperCase())}))),p.a.createElement(A.a,null),p.a.createElement(z.a,null,p.a.createElement(D.a,{button:!0,disabled:!0,className:r.listItem,onClick:s},p.a.createElement(H.a,null,p.a.createElement(I.a,null)),p.a.createElement(B.a,{primary:p.a.createElement(W.a,{variant:"inherit",noWrap:!0},a("SharedMedia"))})),u&&p.a.createElement(D.a,{button:!0,className:r.listItem,onClick:o},p.a.createElement(B.a,{inset:!0,primary:p.a.createElement(W.a,{variant:"inherit",noWrap:!0},a("GroupsInCommon"))}))),S.length>0&&p.a.createElement(p.a.Fragment,null,p.a.createElement(A.a,null),p.a.createElement(z.a,null,S))));return l?p.a.createElement(p.a.Fragment,null,k):p.a.createElement("div",{className:m()("chat-details",n)},k)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId,hasGroupsInCommon:!1}:null}}]),t}(p.a.Component)),Pe=Object(y.a)(Object(Le.c)(),Object(O.c)(),f()(function(e){return{closeIconButton:{margin:"8px -2px 8px 12px"},nested:{},close:{padding:e.spacing.unit/2},listItem:{padding:"11px 22px"}}},{withTheme:!0}),C.withSnackbar,Object(Le.b)())(He),Be=(a(464),function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.onClose;return p.a.createElement("div",{className:"header-master"},p.a.createElement(N.a,{className:t.backIconButton,onClick:a},p.a.createElement(te.a,null)),p.a.createElement("div",{className:"header-status grow cursor-pointer"},p.a.createElement("span",{className:"header-status-content"},"Groups in common")))}}]),t}(p.a.Component)),Fe=f()({backIconButton:{margin:"8px -2px 8px 12px"}})(Be),Ae=(a(465),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSelect=function(e){var t=a.props.popup;Object(we.b)(e.id),t&&Ue.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},a.state={chatIds:[]},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.chatId,a=Object(ae.v)(t);a&&Ue.a.send({"@type":"getGroupsInCommon",user_id:a,offset_chat_id:0,limit:100}).then(function(t){var a=xe.a.getStore();Object(je.l)(a,t.chat_ids),e.setState({chatIds:t.chat_ids})})}},{key:"render",value:function(){var e=this,t=this.props,a=t.minHeight,n=t.onClose,i=t.popup,r=this.state.chatIds.map(function(t){return p.a.createElement(D.a,{button:!0,key:t},p.a.createElement(Z.a,{chatId:t,onSelect:e.handleSelect}))}),s=p.a.createElement(p.a.Fragment,null,p.a.createElement(Fe,{onClose:n}),p.a.createElement("div",{className:"groups-in-common-list",style:{minHeight:a}},r));return i?p.a.createElement(p.a.Fragment,null,s):p.a.createElement("div",{className:"groups-in-common"},s)}}]),t}(p.a.Component));Ae.defaultProps={popup:!1,minHeight:0};var Ve=Ae,ze=a(442),Ge=a.n(ze),We=a(443),qe=a.n(We),Ke=(a(466),function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.close;return p.a.createElement("div",{className:"header-master"},p.a.createElement(N.a,{className:t.backIconButton,onClick:a},p.a.createElement(te.a,null)),p.a.createElement("div",{className:"header-status grow cursor-pointer"},p.a.createElement("span",{className:"header-status-content"},"Shared Media")))}}]),t}(p.a.Component)),Je=f()({backIconButton:{margin:"8px -2px 8px 12px"}})(Ke),$e=(a(467),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={value:0},a.handleChange=function(e,t){a.setState({value:t})},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.popup,n=this.state.value,i=p.a.createElement(p.a.Fragment,null,p.a.createElement(Je,{close:t}),p.a.createElement(Ge.a,{value:n,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",scrollable:!0,scrollButtons:"off",fullWidth:!0},p.a.createElement(qe.a,{label:"Media",style:{minWidth:"40px"}}),p.a.createElement(qe.a,{label:"Docs",style:{minWidth:"40px"}}),p.a.createElement(qe.a,{label:"Links",style:{minWidth:"40px"}}),p.a.createElement(qe.a,{label:"Audio",style:{minWidth:"40px"}})));return a?p.a.createElement(p.a.Fragment,null,i):p.a.createElement("div",{className:"shared-media"},i)}}]),t}(p.a.Component));$e.defaultProps={popup:!1,minHeight:0};var Qe=$e,Xe=a(398),Ye=(a(468),function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onClientUpdateChatId=function(e){a.props.popup||a.setState({chatId:e.nextChatId,userChatId:null,openSharedMedia:!1,openGroupsInCommon:!1})},a.handelOpenSharedMedia=function(){a.setState({openSharedMedia:!0})},a.handleCloseSharedMedia=function(){a.setState({openSharedMedia:!1})},a.handleOpenGroupsInCommon=function(e){console.log("ChatInfo.handleOpenGroupsInCommon",e),a.setState({openGroupsInCommon:!0})},a.handleCloseGroupsInCommon=function(){a.setState({openGroupsInCommon:!1})},a.handleCloseChatDetails=function(){var e=a.props.popup;a.state.userChatId?a.setState({userChatId:null}):e?Ue.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0}):Ee.a.changeChatDetailsVisibility(!1)},a.handleSelectUser=function(){var e=Object(r.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ue.a.send({"@type":"createPrivateChat",user_id:t.id,force:!0});case 4:if(n=e.sent,n=Ie.a.get(n.id)||n){e.next=8;break}return e.abrupt("return");case 8:a.setState({userChatId:n.id});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.detailsRef=p.a.createRef();var n=e.popup;return a.state={chatId:n?Ee.a.dialogChatId:Ee.a.chatId},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){Ee.a.on("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"componentWillUnmount",value:function(){Ee.a.removeListener("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.className,n=e.popup,i=this.state,r=i.chatId,s=i.userChatId,o=i.openSharedMedia,l=i.openGroupsInCommon,c=r||s,d=this.detailsRef&&this.detailsRef.current?this.detailsRef.current.getContentHeight():0,u=null;return u=o?p.a.createElement(Qe,{chatId:c,popup:n,minHeight:d,onClose:this.handleCloseSharedMedia}):l?p.a.createElement(Ve,{chatId:c,popup:n,minHeight:d,onClose:this.handleCloseGroupsInCommon}):p.a.createElement(Pe,{ref:this.detailsRef,chatId:c,popup:n,backButton:s===r,onOpenSharedMedia:this.handelOpenSharedMedia,onOpenGroupsInCommon:this.handleOpenGroupsInCommon,onClose:this.handleCloseChatDetails}),n?p.a.createElement(p.a.Fragment,null,u):p.a.createElement("div",{className:m()(t.borderColor,{"right-column":!n},a)},u)}}]),t}(p.a.Component));Ye.defaultProps={className:null,classes:null,popup:!1};t.default=f()(Xe.b)(Ye)},682:function(e,t,a){},683:function(e,t,a){},690:function(e,t,a){},691:function(e,t,a){},694:function(e,t,a){},695:function(e,t,a){},699:function(e,t,a){},700:function(e,t,a){},701:function(e,t,a){},702:function(e,t,a){},703:function(e,t,a){},704:function(e,t,a){},707:function(e,t,a){},708:function(e,t,a){},709:function(e,t,a){},710:function(e,t,a){},724:function(e,t,a){"use strict";a.r(t);var n=a(7),i=a(10),r=a(12),s=a(11),o=a(13),l=a(0),c=a.n(l),d=a(8),u=a.n(d),p=a(512),h=a(396),m=a(395),g=a(120),f=a.n(g),v=a(445),b=a.n(v),y=a(6),C=a.n(y),O=a(53),S=a(77),I=a(438),U=a(32),E=a.n(U),k=a(78),M=a.n(k),j=a(81),_=a.n(j),w=a(80),L=a.n(w),T=a(82),N=a.n(T),R=a(79),D=a.n(R),x=a(412),H=a.n(x),P=a(426),B=a.n(P),F=a(398),A=a(391),V=a(394),z=a(16),G=a(2),W=(a(682),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).handleCancel=function(){G.a.clientUpdate({"@type":"clientUpdateClearSelection"})},a.handleDelete=function(){var e=!0,t=!0,n=!1,i=void 0;try{for(var r,s=V.a.selectedItems.values()[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value,l=o.chatId,c=o.messageId,d=V.a.get(l,c);if(!d){e=!1;break}if(!d.can_be_deleted_for_all_users){e=!1;break}}}catch(u){n=!0,i=u}finally{try{t||null==s.return||s.return()}finally{if(n)throw i}}a.setState({openDeleteDialog:!0,canBeDeletedForAllUsers:e,revoke:e})},a.handleDeleteContinue=function(){var e,t=a.state.revoke,n=[],i=!0,r=!1,s=void 0;try{for(var o,l=V.a.selectedItems.values()[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var c=o.value,d=c.chatId,u=c.messageId;e=d,n.push(u)}}catch(p){r=!0,s=p}finally{try{i||null==l.return||l.return()}finally{if(r)throw s}}a.handleCancel(),G.a.send({"@type":"deleteMessages",chat_id:e,message_ids:n,revoke:t})},a.handleRevokeChange=function(){a.setState({revoke:!a.state.revoke})},a.handleCloseDelete=function(){a.setState({openDeleteDialog:!1})},a.handleForward=function(){var e,t=[],n=!0,i=!1,r=void 0;try{for(var s,o=V.a.selectedItems.values()[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value,c=l.chatId,d=l.messageId;e=c,t.push(d)}}catch(u){i=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}a.handleCancel(),G.a.clientUpdate({"@type":"clientUpdateForward",info:{chatId:e,messageIds:t}})},a.handleReply=function(){if(1===V.a.selectedItems.size){var e=V.a.selectedItems.values().next().value,t=e.chatId,n=e.messageId;a.handleCancel(),G.a.clientUpdate({"@type":"clientUpdateReply",chatId:t,messageId:n})}},a.state={openDeleteDialog:!1},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.t,n=e.count,i=this.state,r=i.openDeleteDialog,s=i.canBeDeletedForAllUsers,o=i.revoke,l=z.a.getChatId(),d=!0,p=!0,h=!1,m=void 0;try{for(var g,f=V.a.selectedItems.values()[Symbol.iterator]();!(p=(g=f.next()).done);p=!0){var v=g.value,b=v.chatId,y=v.messageId,C=V.a.get(b,y);if(!C){d=!1;break}if(!C.can_be_deleted_only_for_self&&!C.can_be_deleted_for_all_users){d=!1;break}}}catch(F){h=!0,m=F}finally{try{p||null==f.return||f.return()}finally{if(h)throw m}}var O=!0,S=!0,I=!1,U=void 0;try{for(var k,j=V.a.selectedItems.values()[Symbol.iterator]();!(S=(k=j.next()).done);S=!0){var w=k.value,T=w.chatId,R=w.messageId,x=V.a.get(T,R);if(!x){O=!1;break}if(!x.can_be_forwarded){d=!1;break}}}catch(F){I=!0,U=F}finally{try{S||null==j.return||j.return()}finally{if(I)throw U}}var P=1===n&&Object(A.e)(l);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:u()(t.borderColor,"header-command")},O&&c.a.createElement(E.a,{color:"primary",className:t.buttonLeft,onClick:this.handleForward},n<=1?a("Forward"):"".concat(a("Forward")," ").concat(n)),d&&c.a.createElement(E.a,{color:"primary",className:t.buttonLeft,onClick:this.handleDelete},n<=1?a("Delete"):"".concat(a("Delete")," ").concat(n)),P&&c.a.createElement(E.a,{color:"primary",className:t.buttonLeft,onClick:this.handleReply},a("Reply")),c.a.createElement("div",{className:"header-command-space"}),c.a.createElement(E.a,{color:"primary",className:t.buttonRight,onClick:this.handleCancel},a("Cancel"))),c.a.createElement(M.a,{transitionDuration:0,open:r,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title"},c.a.createElement(D.a,{id:"delete-dialog-title"},"Confirm"),c.a.createElement(L.a,null,c.a.createElement(N.a,null,1===n?"Are you sure you want to delete 1 message?":"Are you sure you want to delete ".concat(n," messages?")),s&&c.a.createElement(H.a,{control:c.a.createElement(B.a,{checked:o,onChange:this.handleRevokeChange,color:"primary"}),label:Object(A.Q)(l)?"Delete for ".concat(Object(A.n)(l)):"Delete for all"})),c.a.createElement(_.a,null,c.a.createElement(E.a,{onClick:this.handleCloseDelete,color:"primary"},"Cancel"),c.a.createElement(E.a,{onClick:this.handleDeleteContinue,color:"primary"},"Ok"))))}}]),t}(c.a.Component)),q=Object(S.a)(C()(function(e){return Object(m.a)({buttonLeft:{margin:"14px 0 14px 14px",minWidth:"100px"},buttonRight:{margin:"14px 14px 14px 0",minWidth:"100px"}},Object(F.b)(e))},{withTheme:!0}),Object(O.c)())(W),K=a(69),J=a(45),$=a(408),Q=a(401),X=(a(470),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onUpdateChatOnlineMemberCount=function(e){var t=K.a.get(z.a.getChatId());t&&t.id===e.chat_id&&a.forceUpdate()},a.onClientUpdateMessageSelected=function(e){a.setState({selectionCount:V.a.selectedItems.size})},a.onClientUpdateChatId=function(e){a.forceUpdate()},a.onUpdateConnectionState=function(e){a.setState({connectionState:e.state})},a.onUpdateAuthorizationState=function(e){a.setState({authorizationState:e.authorization_state})},a.onUpdateChatTitle=function(e){var t=K.a.get(z.a.getChatId());t&&t.id===e.chat_id&&a.forceUpdate()},a.onUpdateUserStatus=function(e){var t=K.a.get(z.a.getChatId());if(t&&t.type)switch(t.type["@type"]){case"chatTypeBasicGroup":var n=$.a.getFullInfo(t.type.basic_group_id);if(n&&n.members)n.members.find(function(t){return t.user_id===e.user_id})&&a.forceUpdate();break;case"chatTypePrivate":case"chatTypeSecret":t.type.user_id===e.user_id&&a.forceUpdate()}},a.onUpdateUserChatAction=function(e){z.a.getChatId()===e.chat_id&&a.forceUpdate()},a.onUpdateBasicGroup=function(e){var t=K.a.get(z.a.getChatId());t&&t.type&&"chatTypeBasicGroup"===t.type["@type"]&&t.type.basic_group_id===e.basic_group.id&&a.forceUpdate()},a.onUpdateSupergroup=function(e){var t=K.a.get(z.a.getChatId());t&&t.type&&"chatTypeSupergroup"===t.type["@type"]&&t.type.supergroup_id===e.supergroup.id&&a.forceUpdate()},a.onUpdateBasicGroupFullInfo=function(e){var t=K.a.get(z.a.getChatId());t&&t.type&&"chatTypeBasicGroup"===t.type["@type"]&&t.type.basic_group_id===e.basic_group_id&&a.forceUpdate()},a.onUpdateSupergroupFullInfo=function(e){var t=K.a.get(z.a.getChatId());t&&t.type&&"chatTypeSupergroup"===t.type["@type"]&&t.type.supergroup_id===e.supergroup_id&&a.forceUpdate()},a.onUpdateUserFullInfo=function(e){var t=K.a.get(z.a.getChatId());t&&(!t.type||"chatTypePrivate"!==t.type["@type"]&&"chatTypeSecret"!==t.type["@type"]||t.type.user_id!==e.user_id||a.forceUpdate())},a.openChatDetails=function(){var e=z.a.getChatId();K.a.get(e)&&z.a.changeChatDetailsVisibility(!0)},a.handleSearchChat=function(){var e=z.a.getChatId();K.a.get(e)&&z.a.searchChat(e)},a.localize=function(e){return(0,a.props.t)(e).replace("...","").replace("\u2026","")},a.state={authorizationState:z.a.getAuthorizationState(),connectionState:z.a.getConnectionState()},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return t!==this.state||(e.theme!==this.props.theme||e.t!==this.props.t)}},{key:"componentDidMount",value:function(){z.a.on("updateConnectionState",this.onUpdateConnectionState),z.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),z.a.on("clientUpdateChatId",this.onClientUpdateChatId),V.a.on("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),V.a.on("clientUpdateClearSelection",this.onClientUpdateMessageSelected),K.a.on("updateChatOnlineMemberCount",this.onUpdateChatOnlineMemberCount),K.a.on("updateChatTitle",this.onUpdateChatTitle),J.a.on("updateUserStatus",this.onUpdateUserStatus),K.a.on("updateUserChatAction",this.onUpdateUserChatAction),J.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),$.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Q.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo),$.a.on("updateBasicGroup",this.onUpdateBasicGroup),Q.a.on("updateSupergroup",this.onUpdateSupergroup)}},{key:"componentWillUnmount",value:function(){z.a.removeListener("updateConnectionState",this.onUpdateConnectionState),z.a.removeListener("updateAuthorizationState",this.onUpdateAuthorizationState),z.a.removeListener("clientUpdateChatId",this.onClientUpdateChatId),V.a.removeListener("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),V.a.removeListener("clientUpdateClearSelection",this.onClientUpdateMessageSelected),K.a.removeListener("updateChatOnlineMemberCount",this.onUpdateChatOnlineMemberCount),K.a.removeListener("updateChatTitle",this.onUpdateChatTitle),J.a.removeListener("updateUserStatus",this.onUpdateUserStatus),K.a.removeListener("updateUserChatAction",this.onUpdateUserChatAction),J.a.removeListener("updateUserFullInfo",this.onUpdateUserFullInfo),$.a.removeListener("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Q.a.removeListener("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo),$.a.removeListener("updateBasicGroup",this.onUpdateBasicGroup),Q.a.removeListener("updateSupergroup",this.onUpdateSupergroup)}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.t,n=this.state,i=n.authorizationState,r=n.connectionState,s=n.selectionCount;if(s)return c.a.createElement(q,{count:s});var o=z.a.getChatId(),l=K.a.get(o),d=Object(A.J)(o),p=Object(A.q)(o,!0,a),m=Object(A.o)(o,!0),g=!1;if(r)switch(r["@type"]){case"connectionStateConnecting":p=this.localize("Connecting"),m="",g=!0;break;case"connectionStateConnectingToProxy":p=this.localize("Connecting to proxy"),m="",g=!0;break;case"connectionStateReady":break;case"connectionStateUpdating":p=this.localize("Updating"),m="",g=!0;break;case"connectionStateWaitingForNetwork":p=this.localize("Waiting for network"),m="",g=!0}else if(i)switch(i["@type"]){case"authorizationStateClosed":case" authorizationStateClosing":break;case"authorizationStateLoggingOut":p=this.localize("Logging out"),m="",g=!0;break;case"authorizationStateReady":case"authorizationStateWaitCode":break;case"authorizationStateWaitEncryptionKey":p=this.localize("Loading"),m="",g=!0;break;case"authorizationStateWaitPassword":case"authorizationStateWaitPhoneNumber":break;case"authorizationStateWaitTdlibParameters":p=this.localize("Loading"),m="",g=!0}else p=this.localize("Loading"),m="",g=!0;return c.a.createElement("div",{className:u()(t.borderColor,"header-details")},c.a.createElement("div",{className:u()("header-status","grow",l?"cursor-pointer":"cursor-default"),onClick:this.openChatDetails},c.a.createElement("span",{className:"header-status-content"},p),g&&c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"header-progress"},"."),c.a.createElement("span",{className:"header-progress"},"."),c.a.createElement("span",{className:"header-progress"},".")),c.a.createElement("span",{className:u()("header-status-title",Object(h.a)({},t.headerStatusAccentTitle,d))},m),c.a.createElement("span",{className:"header-status-tail"})),l&&c.a.createElement(c.a.Fragment,null,c.a.createElement(f.a,{className:t.messageSearchIconButton,"aria-label":"Search",onClick:this.handleSearchChat},c.a.createElement(b.a,null)),c.a.createElement(I.a,{openChatDetails:this.openChatDetails})))}}]),t}(l.Component)),Y=Object(S.a)(Object(O.c)(),C()(function(e){return Object(m.a)({button:{margin:"14px"},menuIconButton:{margin:"8px -2px 8px 12px"},searchIconButton:{margin:"8px 12px 8px 0"},messageSearchIconButton:{margin:"8px 0 8px 12px"},moreIconButton:{margin:"8px 12px 8px 0"},headerStatusAccentTitle:{color:e.palette.primary.dark+"!important"}},Object(F.b)(e))},{withTheme:!0}))(X),Z=a(431),ee=a.n(Z),te=a(450),ae=a.n(te),ne=a(693),ie=a.n(ne),re=a(692),se=a.n(re),oe=a(402),le=a.n(oe),ce=a(684),de=a.n(ce),ue=a(685),pe=a.n(ue),he=a(686),me=a.n(he),ge=a(496),fe=a.n(ge),ve=a(497),be=a.n(ve),ye=a(27),Ce=a(403),Oe=(a(683),function(e){function t(){var e,a;Object(n.a)(this,t);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={anchorEl:null,value:Ce.b.volume,prevValue:Ce.b.volume,dragging:!1,buttonOver:!1,popupOver:!1},a.onClientUpdateMediaVolume=function(e){var t=e.volume,n=e.prevVolume;void 0===n?a.setState({value:t}):a.setState({value:t,prevValue:n})},a.handlePopoverOpen=function(e){a.setState({anchorEl:e})},a.handlePopoverClose=function(){var e=a.state,t=e.dragging,n=e.buttonOver,i=e.popupOver;t||n||i||a.setState({anchorEl:null})},a.handleMouseEnter=function(e,t){a.setState({buttonOver:!0}),t&&a.handlePopoverOpen(e.currentTarget)},a.handleMouseLeave=function(){a.setState({buttonOver:!1},function(){a.handlePopoverClose()})},a.handlePopupMouseLeave=function(){a.setState({popupOver:!1},function(){a.handlePopoverClose()})},a.handleVoiceClick=function(){var e=a.state,t=e.value,n=e.prevValue,i=t>0?0:n||ye.z;G.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:i})},a.handleChange=function(e,t){var n=a.state,i=n.dragging,r=n.prevValue;i?G.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:t}):G.a.clientUpdate({"@type":"clientUpdateMediaVolume",prevVolume:t>0?t:r,volume:t})},a.handleDragStart=function(){var e=a.state.value;a.setState({dragging:!0,prevValue:e})},a.handleDragEnd=function(){var e=a.state,t=e.value,n=e.prevValue;a.setState({dragging:!1,prevValue:t>0?t:n},function(){a.handlePopoverClose()})},a.getVolumeIcon=function(e){return 0===e?c.a.createElement(fe.a,{fontSize:"small"}):e<.25?c.a.createElement(de.a,{fontSize:"small"}):e<.5?c.a.createElement(pe.a,{fontSize:"small"}):c.a.createElement(me.a,{fontSize:"small"})},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Ce.b.on("clientUpdateMediaVolume",this.onClientUpdateMediaVolume)}},{key:"componentWillUnmount",value:function(){Ce.b.removeListener("clientUpdateMediaVolume",this.onClientUpdateMediaVolume)}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.anchorEl,i=a.value,r=Boolean(n);return c.a.createElement("div",{onMouseEnter:function(t){return e.handleMouseEnter(t,!0)},onMouseLeave:this.handleMouseLeave,style:{position:"relative",background:"transparent"}},c.a.createElement(f.a,{className:t.iconButton,color:"primary",onClick:this.handleVoiceClick},this.getVolumeIcon(i)),c.a.createElement("div",{style:{position:"absolute",background:"transparent",visibility:r?"visible":"hidden",zIndex:1},onMouseEnter:function(t){return e.handleMouseEnter(t,!1)},onMouseLeave:this.handlePopupMouseLeave},c.a.createElement("div",{className:u()(t.borderColor,t.root),style:{marginTop:8,borderWidth:1,borderStyle:"solid"}},c.a.createElement(be.a,{classes:{container:t.slider},min:0,max:1,value:i,onChange:this.handleChange,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,vertical:!0}))))}}]),t}(c.a.Component)),Se=C()(function(e){return Object(m.a)({iconButton:{padding:4},root:{display:"flex",height:100,padding:"13px 0",background:"dark"===e.palette.type?e.palette.background.default:"#FFFFFF"},slider:{padding:"0 13px"}},Object(F.b)(e))},{withTheme:!0})(Oe),Ie=a(687),Ue=a.n(Ie),Ee=a(688),ke=a.n(Ee),Me=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateMediaRepeat=function(e){var t=e.repeat;a.setState({repeat:t})},a.handleRepeat=function(){var e=a.state.repeat,t=e;switch(e){case Ce.a.NONE:t=Ce.a.REPEAT;break;case Ce.a.REPEAT:t=Ce.a.REPEAT_ONE;break;case Ce.a.REPEAT_ONE:t=Ce.a.NONE}G.a.clientUpdate({"@type":"clientUpdateMediaRepeat",repeat:t})},a.getIcon=function(e){switch(e){case Ce.a.NONE:case Ce.a.REPEAT:return c.a.createElement(Ue.a,{fontSize:"small"});case Ce.a.REPEAT_ONE:return c.a.createElement(ke.a,{fontSize:"small"});default:return c.a.createElement(Ue.a,{fontSize:"small"})}};var i=Ce.b.repeat;return a.state={repeat:i},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Ce.b.on("clientUpdateMediaRepeat",this.onClientUpdateMediaRepeat)}},{key:"componentWillUnmount",value:function(){Ce.b.removeListener("clientUpdateMediaRepeat",this.onClientUpdateMediaRepeat)}},{key:"render",value:function(){var e=this.props.classes,t=this.state.repeat;return c.a.createElement(f.a,{className:e.iconButton,color:t===Ce.a.NONE?"default":"primary",onClick:this.handleRepeat},this.getIcon(t))}}]),t}(c.a.Component),je=C()({iconButton:{padding:4}})(Me),_e=a(689),we=a.n(_e),Le=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateMediaShuffle=function(e){var t=e.shuffle;a.setState({shuffle:t})},a.handleShuffle=function(){var e=a.state.shuffle;G.a.clientUpdate({"@type":"clientUpdateMediaShuffle",shuffle:!e})};var i=Ce.b.shuffle;return a.state={shuffle:i},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Ce.b.on("clientUpdateMediaShuffle",this.onClientUpdateMediaShuffle)}},{key:"componentWillUnmount",value:function(){Ce.b.removeListener("clientUpdateMediaShuffle",this.onClientUpdateMediaShuffle)}},{key:"render",value:function(){var e=this.props.classes,t=this.state.shuffle;return c.a.createElement(f.a,{className:e.iconButton,color:t?"primary":"default",onClick:this.handleShuffle},c.a.createElement(we.a,{fontSize:"small"}))}}]),t}(c.a.Component),Te=C()({iconButton:{padding:4}})(Le),Ne=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateMediaPlaybackRate=function(e){var t=e.playbackRate;a.setState({playbackRate:t})},a.handlePlaybackRate=function(){var e=a.state.playbackRate===ye.w?ye.v:ye.w;G.a.clientUpdate({"@type":"clientUpdateMediaPlaybackRate",playbackRate:e})};var i=Ce.b.playbackRate;return a.state={playbackRate:i},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Ce.b.on("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate)}},{key:"componentWillUnmount",value:function(){Ce.b.removeListener("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate)}},{key:"render",value:function(){var e=this.props.classes,t=this.state.playbackRate;return c.a.createElement(f.a,{className:e.iconButton,color:t>ye.w?"primary":"default",onClick:this.handlePlaybackRate},c.a.createElement("div",{className:"header-player-playback-icon"},"2X"))}}]),t}(c.a.Component),Re=C()({iconButton:{padding:4}})(Ne),De=a(30),xe=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateMediaTime=function(e){var t=e.currentTime;a.setState({currentTime:t,currentTimeString:Object(De.f)(Math.floor(t||0))})},a.getTimeString=function(e,t){Object(De.f)(Math.floor(t||0));return Object(De.f)(Math.floor(e||0))},a.state={currentTime:0,duration:0,timeString:a.getTimeString(0,0)},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Ce.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime)}},{key:"componentWillUnmount",value:function(){Ce.b.removeListener("clientUpdateMediaTime",this.onClientUpdateMediaTime)}},{key:"render",value:function(){var e=this.state.currentTimeString;return c.a.createElement(c.a.Fragment,null,e)}}]),t}(c.a.Component),He=a(9),Pe=a(33),Be=a(397),Fe=(a(690),function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).scrollToActive=function(){var e=a.listRef.current;if(e){var t=Object(He.a)(Object(He.a)(a)).messageId;if(t){var n=a.itemRefMap.get(t);if(n){var i=Pe.findDOMNode(n);i&&(e.scrollTop=i.offsetTop-15)}}}},a.onClientUpdateMediaTitleMouseOver=function(e){var t=e.over;t?a.setState({playlistMouseOver:t},function(){a.tryOpen()}):a.setState({playlistMouseOver:t},function(){a.tryClose()})},a.onClientUpdateMediaActive=function(e){var t=e.chatId,n=e.messageId;a.chatId=t,a.messageId=n},a.onClientUpdateMediaPlaylistLoading=function(e){var t=Object(He.a)(Object(He.a)(a)),n=t.chatId,i=t.messageId;e.chatId===n&&e.messageId===i&&a.setState({playlist:null})},a.onClientUpdateMediaPlaylist=function(e){var t=Object(He.a)(Object(He.a)(a)),n=t.chatId,i=t.messageId,r=e.playlist;n===r.chatId&&i===r.messageId&&a.setState({playlist:r})},a.tryOpen=function(){clearTimeout(a.openTimeout),a.openTimeout=setTimeout(function(){var e=a.state,t=e.titleMouseOver,n=e.playlistMouseOver;a.setState({open:t||n})},250)},a.tryClose=function(){clearTimeout(a.timeout),a.timeout=setTimeout(function(){var e=a.state,t=e.titleMouseOver,n=e.playlistMouseOver;a.setState({open:t||n})},250)},a.handleMouseEnter=function(){a.setState({playlistMouseOver:!0,open:!0})},a.handleMouseLeave=function(){a.setState({playlistMouseOver:!1},function(){a.tryClose()})},a.handleScroll=function(){var e=a.listRef.current;e&&(0===e.scrollTop?G.a.clientUpdate({"@type":"clientUpdateMediaPlaylistNext"}):e.scrollHeight===e.scrollTop+e.offsetHeight&&G.a.clientUpdate({"@type":"clientUpdateMediaPlaylistPrev"}))},a.listRef=c.a.createRef(),a.itemRefMap=new Map;var i=Ce.b.message,o=Ce.b.playlist;return a.chatId=i?i.chat_id:0,a.messageId=i?i.id:0,a.state={open:!1,titleMouseOver:!1,playlistMouseOver:!1,playlist:o},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){var n=this.state.open;!t.open&&n&&this.scrollToActive()}},{key:"componentDidMount",value:function(){Ce.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ce.b.on("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Ce.b.on("clientUpdateMediaPlaylistLoading",this.onClientUpdateMediaPlaylistLoading),Ce.b.on("clientUpdateMediaTitleMouseOver",this.onClientUpdateMediaTitleMouseOver)}},{key:"componentWillUnmount",value:function(){Ce.b.removeListener("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ce.b.removeListener("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Ce.b.removeListener("clientUpdateMediaPlaylistLoading",this.onClientUpdateMediaPlaylistLoading),Ce.b.removeListener("clientUpdateMediaTitleMouseOver",this.onClientUpdateMediaTitleMouseOver)}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.open,i=a.playlist;if(!n)return null;if(!i)return null;var r=i.messages;return r?r.length<=1?null:(this.itemRefMap.clear(),c.a.createElement("div",{className:"playlist"},c.a.createElement("div",{className:u()("playlist-wrapper",t.root,t.borderColor)},c.a.createElement("div",{ref:this.listRef,className:"playlist-items",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onScroll:this.handleScroll},i.messages.slice(0).reverse().map(function(t){return c.a.createElement("div",{key:t.id,ref:function(a){return e.itemRefMap.set(t.id,a)},className:"playlist-item"},Object(Be.h)(t,function(){return Object(Be.z)(t.chat_id,t.id)}))}))))):null}}]),t}(c.a.Component)),Ae=C()(function(e){return Object(m.a)({root:{background:"dark"===e.palette.type?e.palette.background.default:"#FFFFFF"}},Object(F.b)(e))})(Fe),Ve=a(393),ze=a(121),Ge=a(392),We=(a(691),function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateMediaPlaybackRate=function(e){var t=e.playbackRate,n=a.videoRef.current;n&&(n.playbackRate=t)},a.onClientUpdateMediaVolume=function(e){var t=e.volume,n=a.videoRef.current;n&&(n.volume=t)},a.onClientUpdateMediaViewerContent=function(e){a.playingMediaViewer=Boolean(z.a.mediaViewerContent)},a.onClientUpdateMediaViewerEnded=function(e){a.playingMediaViewer=!1},a.onClientUpdateMediaViewerPause=function(e){a.playingMediaViewer=!1},a.onClientUpdateMediaViewerPlay=function(e){a.playingMediaViewer=!0;var t=a.videoRef.current;t&&t.pause()},a.startPlayingFile=function(e,t){var n=t.chat_id,i=t.id;a.setState({src:a.getMediaSrc(t)},function(){var e=a.videoRef.current;e&&a.playingMediaViewer&&(e.pause(),G.a.clientUpdate({"@type":"clientUpdateMediaPause",chatId:n,messageId:i}))})},a.onClientUpdateMediaBlob=function(e){var t=e.chatId,n=e.messageId,i=a.state.message;if(i){var r=i.chat_id,s=i.id,o=i.content;if(o&&t===r&&n===s)switch(o["@type"]){case"messageText":var l=o.web_page;if(l){var c=l.audio,d=l.voice_note,u=l.video_note;if(c){var p=c.audio;p&&a.startPlayingFile(p,i)}if(d){var h=d.voice;h&&a.startPlayingFile(h,i)}if(u){var m=u.video;m&&a.startPlayingFile(m,i)}}break;case"messageAudio":var g=o.audio;if(g){var f=g.audio;f&&a.startPlayingFile(f,i)}break;case"messageVoiceNote":var v=o.voice_note;if(v){var b=v.voice;b&&a.startPlayingFile(b,i)}break;case"messageVideoNote":var y=o.video_note;if(y){var C=y.video;C&&a.startPlayingFile(C,i)}}}},a.onClientUpdateMediaPlaylist=function(e){var t=e.playlist,n=t.chatId,i=t.messageId,r=a.state.message;r&&r.chat_id===n&&r.id===i&&a.setState({playlist:t})},a.onClientUpdateMediaClose=function(e){a.setState({message:null,playlist:null,playing:!1,src:null})},a.onClientUpdateMediaActive=function(e){var t=e.chatId,n=e.messageId,i=a.state,r=i.message,s=i.src;if(r&&r.chat_id===t&&r.id===n){if(s){var o=a.videoRef.current;o&&(o.paused?o.play():o.pause())}}else{var l=a.getMediaSrc(Ce.b.message),c=Boolean(l);Ce.b.playlist;a.setState({message:Ce.b.message,playlist:Ce.b.playlist,playing:c,src:l},function(){var e=a.videoRef.current;e&&(e.currentTime=a.startTime,a.playingMediaViewer&&e.pause())})}},a.handlePrev=function(){G.a.clientUpdate({"@type":"clientUpdateMediaPrev"})},a.handlePlay=function(){var e=a.state.message;e&&G.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:e.chat_id,messageId:e.id})},a.handleNext=function(){G.a.clientUpdate({"@type":"clientUpdateMediaNext"})},a.getMediaSrc=function(e){if(e){var t=e.content;if(t){var a=t.audio,n=t.voice_note,i=t.video_note,r=t.web_page;if(a){var s=a.audio;if(s)return Object(Ve.h)(s)}if(n){var o=n.voice;if(o)return Object(Ve.h)(o)}if(i){var l=i.video;if(l)return Object(Ve.h)(l)}if(r){if(r.audio){var c=r.audio.audio;if(c)return Object(Ve.h)(c)}if(r.voice_note){var d=r.voice_note.voice;if(d)return Object(Ve.h)(d)}if(r.video_note){var u=r.video_note.video;if(u)return Object(Ve.h)(u)}}}}return""},a.handleEnded=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=a.state.message;t&&(G.a.clientUpdate({"@type":"clientUpdateMediaEnding",chatId:t.chat_id,messageId:t.id,moveNext:e}),a.setState({},function(){G.a.clientUpdate({"@type":"clientUpdateMediaEnd",chatId:t.chat_id,messageId:t.id,moveNext:e})}))},a.handleVideoEnded=function(){a.handleEnded(!0)},a.handleClose=function(){var e=a.videoRef.current;e&&e.pause(),a.handleEnded(!1)},a.handleTimeUpdate=function(){var e=a.state.message;if(e){var t=a.videoRef.current;t&&(a.setState({currentTime:t.currentTime,currentTimeString:Object(De.f)(Math.floor(t.currentTime||0))}),G.a.clientUpdate({"@type":"clientUpdateMediaTime",chatId:e.chat_id,messageId:e.id,duration:t.duration,currentTime:t.currentTime,timestamp:Date.now()}))}},a.handleCanPlay=function(){var e=a.state.message;if(e){var t=a.videoRef.current;if(t){var n=Ce.b.playbackRate,i=Ce.b.volume,r=e.chat_id,s=e.id,o=Object(Be.q)(r,s);if(t.playbackRate=o?ye.w:n,t.volume=i,t.muted=!1,!o){var l=null;"captureStream"in t?l=t.captureStream():"mozCaptureStream"in t&&(l=t.mozCaptureStream()),l&&G.a.clientUpdate({"@type":"clientUpdateMediaCaptureStream",chatId:e.chat_id,messageId:e.id,stream:l})}}}},a.handleVideoPlay=function(){var e=a.state.message;if(e){a.setState({playing:!0});var t=a.videoRef.current;t&&G.a.clientUpdate({"@type":"clientUpdateMediaPlay",chatId:e.chat_id,messageId:e.id,currentTime:t.currentTime,duration:t.duration,timestamp:Date.now()})}},a.handleVideoPause=function(){var e=a.state.message;e&&(a.setState({playing:!1}),a.videoRef.current&&G.a.clientUpdate({"@type":"clientUpdateMediaPause",chatId:e.chat_id,messageId:e.id}))},a.handlePlaybackRate=function(){var e=a.state.playbackRate===ye.w?ye.v:ye.w;a.setState({playbackRate:e},function(){var t=a.videoRef.current;t&&(t.playbackRate=e)}),G.a.clientUpdate({"@type":"clientUpdateMediaPlaybackRate",playbackRate:e})},a.hasPrev=function(e,t){if(!e)return!1;if(!t||!t.messages.length)return!1;var a=e.chat_id,n=e.id,i=t.messages.findIndex(function(e){return e.chat_id===a&&e.id===n});return-1!==i&&i+1<t.messages.length},a.hasNext=function(e,t){if(!e)return!1;if(!t||!t.messages.length)return!1;var a=e.chat_id,n=e.id,i=t.messages.findIndex(function(e){return e.chat_id===a&&e.id===n});return-1!==i&&i-1>=0},a.handleTitleMouseEnter=function(){G.a.clientUpdate({"@type":"clientUpdateMediaTitleMouseOver",over:!0})},a.handleTitleMouseLeave=function(){G.a.clientUpdate({"@type":"clientUpdateMediaTitleMouseOver",over:!1})},a.handleTitleClick=function(){var e=a.state.message;e&&Object(ze.b)(e.chat_id,e.id)},a.videoRef=c.a.createRef();var i=Ce.b.message,o=Ce.b.playlist;return a.startTime=ye.y,a.state={currentTime:0,currentTimeString:Object(De.f)(0),message:i,playlist:o,playing:!1,src:a.getMediaSrc(i)},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props.theme,i=this.state,r=i.message,s=i.playlist,o=i.src,l=i.playing;return e.theme!==n||(t.message!==r||(t.playlist!==s||(t.src!==o||t.playing!==l)))}},{key:"componentDidMount",value:function(){Ge.a.on("clientUpdateVoiceNoteBlob",this.onClientUpdateMediaBlob),Ge.a.on("clientUpdateVideoNoteBlob",this.onClientUpdateMediaBlob),Ge.a.on("clientUpdateAudioBlob",this.onClientUpdateMediaBlob),Ce.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ce.b.on("clientUpdateMediaClose",this.onClientUpdateMediaClose),Ce.b.on("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Ce.b.on("clientUpdateMediaViewerPlay",this.onClientUpdateMediaViewerPlay),Ce.b.on("clientUpdateMediaViewerPause",this.onClientUpdateMediaViewerPause),Ce.b.on("clientUpdateMediaViewerEnded",this.onClientUpdateMediaViewerEnded),Ce.b.on("clientUpdateMediaVolume",this.onClientUpdateMediaVolume),Ce.b.on("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate),z.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}},{key:"componentWillUnmount",value:function(){Ge.a.removeListener("clientUpdateVoiceNoteBlob",this.onClientUpdateMediaBlob),Ge.a.removeListener("clientUpdateVideoNoteBlob",this.onClientUpdateMediaBlob),Ge.a.removeListener("clientUpdateAudioBlob",this.onClientUpdateMediaBlob),Ce.b.removeListener("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ce.b.removeListener("clientUpdateMediaClose",this.onClientUpdateMediaClose),Ce.b.removeListener("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Ce.b.removeListener("clientUpdateMediaViewerPlay",this.onClientUpdateMediaViewerPlay),Ce.b.removeListener("clientUpdateMediaViewerPause",this.onClientUpdateMediaViewerPause),Ce.b.removeListener("clientUpdateMediaViewerEnded",this.onClientUpdateMediaViewerEnded),Ce.b.removeListener("clientUpdateMediaVolume",this.onClientUpdateMediaVolume),Ce.b.removeListener("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate),z.a.removeListener("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.playing,n=t.message,i=t.playlist,r=t.src,s=!1;if(n){var o=n.chat_id,l=n.id;s=Object(Be.q)(o,l)}var d=Object(Be.i)(n),p=Object(Be.d)(n),h=Object(Be.c)(n),m=!s,g=!s,v=s,b=s,y=this.hasPrev(n,i),C=this.hasNext(n,i);return c.a.createElement(c.a.Fragment,null,c.a.createElement("video",{className:"header-player-video",ref:this.videoRef,src:r,autoPlay:!0,controls:!1,width:44,height:44,onCanPlay:this.handleCanPlay,onPlay:this.handleVideoPlay,onPause:this.handleVideoPause,onTimeUpdate:this.handleTimeUpdate,onEnded:this.handleVideoEnded}),n&&c.a.createElement("div",{className:u()(e.borderColor,"header-player")},c.a.createElement(f.a,{disabled:!y,className:e.iconButton,color:"primary",onClick:this.handlePrev},c.a.createElement(se.a,{fontSize:"small"})),c.a.createElement(f.a,{className:e.iconButton,color:"primary",disabled:!r,onClick:this.handlePlay},a?c.a.createElement(ae.a,null):c.a.createElement(ee.a,null)),c.a.createElement(f.a,{disabled:!C,className:e.iconButton,color:"primary",onClick:this.handleNext},c.a.createElement(ie.a,{fontSize:"small"})),c.a.createElement(Ae,null),c.a.createElement("div",{className:"header-player-content",onMouseEnter:this.handleTitleMouseEnter,onMouseLeave:this.handleTitleMouseLeave,onClick:this.handleTitleClick},c.a.createElement("div",{className:"header-player-title"},d,m&&c.a.createElement("span",{title:p},"\xa0",h)),"\xa0",c.a.createElement(xe,null)),c.a.createElement(Se,null),g&&c.a.createElement(Re,null),v&&c.a.createElement(je,null),b&&c.a.createElement(Te,null),c.a.createElement(f.a,{className:e.iconButton,onClick:this.handleClose},c.a.createElement(le.a,{fontSize:"small"}))))}}]),t}(c.a.Component)),qe=Object(S.a)(Object(O.c)(),C()(function(e){return Object(m.a)({iconButton:{padding:4}},Object(F.b)(e))},{withTheme:!0}))(We),Ke=a(55),Je=a(14),$e=a.n(Je),Qe=a(24),Xe=(a(694),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateDragging=function(e){a.setState({dragging:z.a.getDragging()})},a.handleDragEnter=function(e){e.preventDefault(),e.stopPropagation()},a.handleDrop=function(e){e.preventDefault(),e.stopPropagation(),z.a.setDragging(!1),a.handleAttachDocumentComplete(e.dataTransfer.files)},a.handleDragLeave=function(e){e.preventDefault(),e.stopPropagation(),z.a.setDragging(!1)},a.handleAttachDocumentComplete=function(e){if(0!==e.length)for(var t=0;t<e.length;t++){var n=e[t],i={"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:n.name,data:n}};a.onSendInternal(i,function(e){return Ge.a.uploadFile(e.content.document.document.id,e)})}},a.onSendInternal=function(){var e=Object(Qe.a)($e.a.mark(function e(t,a){var n,i;return $e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=z.a.getChatId()){e.next=3;break}return e.abrupt("return");case 3:if(t){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,z.a.invokeScheduledAction("clientUpdateClearHistory chatId=".concat(n)),e.next=9,G.a.send({"@type":"sendMessage",chat_id:n,reply_to_message_id:0,input_message_content:t});case 9:i=e.sent,G.a.send({"@type":"viewMessages",chat_id:n,message_ids:[i.id]}),a(i),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),alert("sendMessage error "+JSON.stringify(e.t0));case 17:case"end":return e.stop()}},e,null,[[5,14]])}));return function(t,a){return e.apply(this,arguments)}}(),a.state={dragging:z.a.getDragging()},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){z.a.on("clientUpdateDragging",this.onClientUpdateDragging)}},{key:"componentWillUnmount",value:function(){z.a.removeListener("clientUpdateDragging",this.onClientUpdateDragging)}},{key:"render",value:function(){var e=this.state.dragging;return c.a.createElement(c.a.Fragment,null,e&&c.a.createElement("div",{className:"files-drop-target",onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},c.a.createElement("div",{className:"files-drop-target-wrapper"},c.a.createElement("div",{className:"files-drop-target-text"},c.a.createElement("div",{className:"files-drop-target-title"},"Drop files here"),c.a.createElement("div",{className:"files-drop-target-subtitle"},"to send them without compression")))))}}]),t}(c.a.Component)),Ye=a(515),Ze=a(475),et=a.n(Ze);a(695);var tt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={arrowRef:null},a.handleArrowRef=function(e){a.setState({arrowRef:e})},a.openForward=function(e){e.stopPropagation();var t=a.props.forwardInfo;if(!t)return null;var n=t.origin;switch(n["@type"]){case"messageForwardOriginUser":var i=n.sender_user_id;Object(ze.c)(i,!0);break;case"messageForwardOriginHiddenUser":break;case"messageForwardOriginChannel":var r=n.chat_id,s=n.message_id;Object(ze.b)(r,s,!0)}},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.classes,n=e.forwardInfo,i=this.state.arrowRef,r=Object(Be.f)(n,t),s=Object(Be.v)(n)?c.a.createElement(c.a.Fragment,null,t("HidAccount"),c.a.createElement("span",{className:a.arrow,ref:this.handleArrowRef})):"";return c.a.createElement("div",{className:u()("message-author",a.forwardColor,"forward")},"".concat(t("ForwardedMessage"),"\n").concat(t("From")," "),c.a.createElement(et.a,{title:s,classes:{popper:a.arrowPopper,tooltip:a.tooltip},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:Boolean(i),element:i}}}},placement:"top"},c.a.createElement("a",{onClick:this.openForward},r)))}}]),t}(c.a.Component),at=Object(S.a)(C()(function(e){return{forwardColor:{color:e.palette.primary.main},arrowPopper:(t=e.palette.grey[700],{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.95em",width:"3em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(t," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.95em",width:"3em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(t," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.95em",height:"3em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(t," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.95em",height:"3em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(t)}}}),arrow:{position:"absolute",fontSize:6,width:"3em",height:"3em","&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}},tooltip:{margin:"6px 0 26px 0"}};var t},{withTheme:!0}),Object(O.c)())(tt),nt=(a(699),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).handleUpdateMessageSend=a.handleUpdateMessageSend.bind(Object(He.a)(Object(He.a)(a))),a.handleUpdateChatReadOutbox=a.handleUpdateChatReadOutbox.bind(Object(He.a)(Object(He.a)(a))),a.state={sendingState:e.sendingState,unread:!0},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){V.a.on("updateMessageSendFailed",this.handleUpdateMessageSend),V.a.on("updateMessageSendSucceeded",this.handleUpdateMessageSend),K.a.on("updateChatReadOutbox",this.handleUpdateChatReadOutbox)}},{key:"handleUpdateMessageSend",value:function(e){this.props.messageId===e.old_message_id&&e.message&&(this.newMessageId=e.message.id,this.setState({sendingState:e.message.sending_state}))}},{key:"handleUpdateChatReadOutbox",value:function(e){this.props.chatId===e.chat_id&&(this.props.newMessageId&&this.props.newMessageId<=e.last_read_outbox_message_id||this.props.messageId<=e.last_read_outbox_message_id)&&this.setState({sendingState:null,unread:!1})}},{key:"componentWillUnmount",value:function(){V.a.removeListener("updateMessageSendFailed",this.handleUpdateMessageSend),V.a.removeListener("updateMessageSendSucceeded",this.handleUpdateMessageSend),K.a.removeListener("updateChatReadOutbox",this.handleUpdateChatReadOutbox)}},{key:"render",value:function(){var e="messagestatus-succeded";return this.state.sendingState&&(e="messageSendingStateFailed"===this.state.sendingState["@type"]?"messagestatus-failed":"messagestatus-pending"),this.state.unread&&c.a.createElement("i",{className:u()("messagestatus-icon",e)})}}]),t}(c.a.Component)),it=a(436),rt=a(416),st=a(404);a(700);var ot=C()(function(e){return{unreadSeparator:{background:"dark"===e.palette.type?e.palette.grey[800]:"#f0f4f7",color:"dark"===e.palette.type?e.palette.text.primary:"#8096a8"}}})(function(e){var t=e.classes;return c.a.createElement("div",{className:u()("unread-separator",t.unreadSeparator)},"Unread messages")}),lt=a(451),ct=a(432),dt=a(493),ut=a(490),pt=a(489),ht=a(514),mt=a(494),gt=a(434),ft=(a(701),function(e){function t(){var e,a;Object(n.a)(this,t);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).getContent=function(){var e=a.props,t=e.classes,n=e.chatId,i=e.messageId,r=e.size,s=(e.displaySize,e.displaySmallSize),o=e.openMedia,l=V.a.get(n,i);if(!l)return null;var d=l.content;if(!d)return null;var p=d.web_page;if(!p)return null;var h=p.site_name,m=p.title,g=p.description,f=(p.url,p.photo),v=p.animation,b=p.video,y=p.audio,C=p.document,O=p.voice_note,S=p.video_note,I=p.sticker,U=p.type;if(I)return c.a.createElement(c.a.Fragment,null,h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g),c.a.createElement(gt.a,{chatId:n,messageId:i,sticker:I,openMedia:o}));if(O)return c.a.createElement(c.a.Fragment,null,h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g),c.a.createElement(ht.a,{chatId:n,messageId:i,voiceNote:O,openMedia:o}));if(S)return c.a.createElement(c.a.Fragment,null,h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g),c.a.createElement(mt.a,{chatId:n,messageId:i,videoNote:S,openMedia:o}));if(y)return c.a.createElement(c.a.Fragment,null,h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g),c.a.createElement(ut.a,{chatId:n,messageId:i,audio:y,openMedia:o}));if(C)return c.a.createElement(c.a.Fragment,null,h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g),c.a.createElement(pt.a,{chatId:n,messageId:i,document:C,openMedia:o}));if(v&&(Object(Ve.h)(v.animation)||v.thumbnail))return c.a.createElement(c.a.Fragment,null,h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g),c.a.createElement(lt.a,{chatId:n,messageId:i,animation:v,openMedia:o}));if(b&&b.thumbnail)return c.a.createElement(c.a.Fragment,null,h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g),c.a.createElement(dt.a,{chatId:n,messageId:i,video:b,openMedia:o}));if(f){var E=Object(De.m)(f.sizes,r),k=("article"===U||"photo"===U)&&(h||m||g)&&E&&E.width===E.height,M=k?{float:"right",marginLeft:6,marginBottom:6}:{};return c.a.createElement(c.a.Fragment,null,k&&c.a.createElement(ct.a,{displaySize:s,style:M,chatId:n,messageId:i,photo:f,openMedia:o}),h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g),!k&&c.a.createElement(ct.a,{chatId:n,messageId:i,photo:f,openMedia:o}))}return c.a.createElement(c.a.Fragment,null,h&&c.a.createElement("div",{className:u()("web-page-site-name",t.accentColorDark)},h),m&&c.a.createElement("div",{className:"web-page-title"},m),g&&c.a.createElement("div",{className:"web-page-description"},g))},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.classes;return c.a.createElement("div",{className:"web-page"},c.a.createElement("div",{className:u()("web-page-border",e.accentBackgroundLight)}),c.a.createElement("div",{className:"web-page-wrapper"},this.getContent()))}}]),t}(c.a.Component));ft.defaultProps={size:ye.t,displaySize:ye.r,displaySmallSize:ye.s};var vt=C()(function(e){return Object(m.a)({},Object(F.a)(e))})(ft),bt=(a(702),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateClearSelection=function(e){a.state.selected&&a.setState({selected:!1})},a.onClientUpdateMessageHighlighted=function(e){var t=a.props,n=t.chatId,i=t.messageId,r=a.state,s=r.selected,o=r.highlighted;s||(n===e.chatId&&i===e.messageId?o?a.setState({highlighted:!1},function(){setTimeout(function(){a.setState({highlighted:!0})},0)}):a.setState({highlighted:!0}):o&&a.setState({highlighted:!1}))},a.onClientUpdateMessageSelected=function(e){var t=a.props,n=t.chatId,i=t.messageId,r=e.selected;n===e.chatId&&i===e.messageId&&a.setState({selected:r,highlighted:!1})},a.onUpdateMessageEdited=function(e){var t=e.chat_id,n=e.message_id,i=a.props,r=i.chatId,s=i.messageId;r===t&&s===n&&a.forceUpdate()},a.onUpdateMessageViews=function(e){var t=e.chat_id,n=e.message_id,i=a.props,r=i.chatId,s=i.messageId;r===t&&s===n&&a.forceUpdate()},a.onUpdateMessageContent=function(e){var t=e.chat_id,n=e.message_id,i=a.props,r=i.chatId,s=i.messageId;if(r===t&&s===n){var o=V.a.get(r,s);if(o){var l=o.content;if(l)switch(l["@type"]){case"messagePoll":a.forceUpdate()}}}},a.handleSelectUser=function(e){Object(ze.c)(e,!0)},a.handleSelectChat=function(e){Object(ze.b)(e,!0)},a.handleSelection=function(){if(a.mouseDown&&!window.getSelection().toString()){var e=a.props,t=e.chatId,n=e.messageId,i=!V.a.selectedItems.has("chatId=".concat(t,"_messageId=").concat(n));Object(ze.d)(t,n,i)}},a.handleDateClick=function(e){e.preventDefault(),e.stopPropagation();var t=a.props,n=t.chatId,i=t.messageId,r=V.a.get(n,i);Object(A.e)(n)?G.a.clientUpdate({"@type":"clientUpdateReply",chatId:n,messageId:i}):r&&r.can_be_forwarded&&G.a.clientUpdate({"@type":"clientUpdateForward",info:{chatId:n,messageIds:[i]}})},a.openMedia=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=a.props,n=t.chatId,i=t.messageId;Object(Be.z)(n,i)},a.handleAnimationEnd=function(){a.setState({highlighted:!1})},a.handleMouseDown=function(){a.mouseDown=!0},a.handleMouseOver=function(){a.mouseDown=!1},a.handleMouseOut=function(){a.mouseOut=!1},a.state={selected:!1,highlighted:!1},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.theme,i=a.chatId,r=a.messageId,s=a.sendingState,o=a.showUnreadSeparator,l=this.state,c=l.contextMenu,d=l.selected,u=l.highlighted;return e.theme!==n||(e.chatId!==i||(e.messageId!==r||(e.sendingState!==s||(e.showUnreadSeparator!==o||(t.contextMenu!==c||(t.selected!==d||t.highlighted!==u))))))}},{key:"componentDidMount",value:function(){V.a.on("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted),V.a.on("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),V.a.on("clientUpdateClearSelection",this.onClientUpdateClearSelection),V.a.on("updateMessageContent",this.onUpdateMessageContent),V.a.on("updateMessageEdited",this.onUpdateMessageEdited),V.a.on("updateMessageViews",this.onUpdateMessageViews)}},{key:"componentWillUnmount",value:function(){V.a.removeListener("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted),V.a.removeListener("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),V.a.removeListener("clientUpdateClearSelection",this.onClientUpdateClearSelection),V.a.removeListener("updateMessageContent",this.onUpdateMessageContent),V.a.removeListener("updateMessageEdited",this.onUpdateMessageEdited),V.a.removeListener("updateMessageViews",this.onUpdateMessageViews)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.classes,n=e.chatId,i=e.messageId,r=e.showUnreadSeparator,s=this.state,o=(s.contextMenu,s.left,s.top,s.selected),l=s.highlighted,d=V.a.get(n,i);if(!d)return c.a.createElement("div",null,"[empty message]");var p=d.sending_state,m=d.views,g=d.edit_date,f=d.reply_to_message_id,v=d.forward_info,b=Object(Be.m)(d),y=Object(Be.p)(d),C=Object(Be.c)(d),O=Object(Be.d)(d),S=Object(Be.h)(d,this.openMedia);this.unread=Object(Be.o)(d);var I=Object(Be.l)(d),U=I?c.a.createElement(rt.a,{userId:I,onSelect:this.handleSelectUser}):c.a.createElement(st.a,{chatId:n,onSelect:this.handleSelectChat}),E=u()("message",{"message-selected":o},Object(h.a)({},a.messageSelected,o),Object(h.a)({},a.messageHighlighted,l&&!o));return c.a.createElement("div",{className:E,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown,onClick:this.handleSelection,onAnimationEnd:this.handleAnimationEnd},r&&c.a.createElement(ot,null),c.a.createElement("div",{className:"message-wrapper"},c.a.createElement("i",{className:"message-select-tick"}),this.unread&&c.a.createElement(nt,{chatId:n,messageId:i,sendingState:p}),U,c.a.createElement("div",{className:"message-content"},c.a.createElement("div",{className:"message-title"},!v&&c.a.createElement(it.a,{chatId:n,openChat:!0,userId:I,openUser:!0}),v&&c.a.createElement(at,{forwardInfo:v}),c.a.createElement("div",{className:"message-meta"},c.a.createElement("span",null,"\xa0"),m>0&&c.a.createElement(c.a.Fragment,null,c.a.createElement("i",{className:"message-views-icon"}),c.a.createElement("span",{className:"message-views"},"\xa0",m,"\xa0 \xa0")),g>0&&c.a.createElement("span",null,t("EditedMessage"),"\xa0"),c.a.createElement("a",{className:"message-date",onClick:this.handleDateClick},c.a.createElement("span",{title:O},C)))),Boolean(f)&&c.a.createElement(Ye.a,{chatId:n,messageId:f}),S,c.a.createElement("div",{className:"message-text"},b),y&&c.a.createElement(vt,{chatId:n,messageId:i,openMedia:this.openMedia}))))}}]),t}(l.Component)),yt=Object(S.a)(C()(function(e){return{messageAuthorColor:{color:e.palette.primary.main},messageSelected:{backgroundColor:e.palette.primary.main+"22"},"@keyframes highlighted":{from:{backgroundColor:e.palette.primary.main+"22"},to:{backgroundColor:"transparent"}},messageHighlighted:{animation:"highlighted 4s ease-out"}}},{withTheme:!0}),Object(O.c)())(bt),Ct=a(446),Ot=(a(703),{width:64,height:64,borderRadius:"50%",margin:"-8px auto 16px auto"}),St=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateMessageHighlighted=function(e){var t=a.props,n=t.chatId,i=t.messageId,r=a.state,s=r.selected,o=r.highlighted;s||(n===e.chatId&&i===e.messageId?o?a.setState({highlighted:!1},function(){setTimeout(function(){a.setState({highlighted:!0})},0)}):a.setState({highlighted:!0}):o&&a.setState({highlighted:!1}))},a.handleAnimationEnd=function(){a.setState({highlighted:!1})},a.openMedia=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=a.props,n=t.chatId,i=t.messageId;Object(Be.z)(n,i)},a.state={highlighted:!1},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,i=a.messageId,r=a.sendingState,s=a.showUnreadSeparator,o=this.state.highlighted;return e.chatId!==n||(e.messageId!==i||(e.sendingState!==r||(e.showUnreadSeparator!==s||t.highlighted!==o)))}},{key:"componentDidMount",value:function(){V.a.on("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted)}},{key:"componentWillUnmount",value:function(){V.a.removeListener("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted)}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.chatId,n=e.messageId,i=e.showUnreadSeparator,r=this.state.highlighted,s=V.a.get(a,n);if(!s)return c.a.createElement("div",null,"[empty service message]");var o=s.content;if(!o)return c.a.createElement("div",null,"[empty service message]");var l=o.photo,d=Object(Ct.a)(s,!0),p=u()("service-message",Object(h.a)({},t.messageHighlighted,r));return c.a.createElement("div",{className:p,onAnimationEnd:this.handleAnimationEnd},i&&c.a.createElement(ot,null),c.a.createElement("div",{className:"service-message-wrapper"},c.a.createElement("div",{className:"service-message-content"},d)),l&&c.a.createElement(ct.a,{chatId:a,messageId:n,photo:l,style:Ot,openMedia:this.openMedia}))}}]),t}(c.a.Component),It=C()(function(e){return{"@keyframes highlighted":{from:{backgroundColor:e.palette.primary.main+"22"},to:{backgroundColor:"transparent"}},messageHighlighted:{animation:"highlighted 4s ease-out"}}},{withTheme:!0})(St),Ut=a(437),Et=(a(704),a(46)),kt=a.n(Et),Mt=a(418),jt=a.n(Mt),_t=a(125),wt=a(705),Lt=a.n(wt),Tt=a(459),Nt=a.n(Tt),Rt=a(706),Dt=a.n(Rt),xt=a(406),Ht=a.n(xt),Pt=a(405),Bt=a.n(Pt),Ft=a(414),At=a.n(Ft),Vt=a(411),zt=a.n(Vt),Gt=a(60),Wt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={anchorEl:null},a.handleMenuClick=function(e){a.handleOpen(e.currentTarget)},a.handleOpen=function(e){a.setState({anchorEl:e})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleCopyLink=function(){a.handleClose();var e=a.props.t,t=a.getStickersLink(Ut.a.stickerSet);if(t){jt()(t);var n="".concat(t,"_copy_stickers_link"),i=e("LinkCopied");a.handleScheduledAction(n,i,null)}},a.getStickersLink=function(e){if(!e)return"";var t=e.name;if(!t)return"";var a=Gt.a.get("t_me_url");return(a?a.value:"https://telegram.org/")+"addstickers/"+t},a.handleScheduledAction=function(e,t,n){if(e){var i=a.props,r=i.enqueueSnackbar,s=i.classes;i.t;if(r){z.a.addScheduledAction(e,ye.p+300,n)&&r(t,{autoHideDuration:ye.p,action:[c.a.createElement(f.a,{key:"close","aria-label":"Close",color:"inherit",className:s.close,onClick:function(){return z.a.removeScheduledAction(e)}},c.a.createElement(le.a,null))]})}}},a.handleShare=function(){a.handleClose();var e=a.getStickersLink(Ut.a.stickerSet);e&&(G.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:null}),G.a.clientUpdate({"@type":"clientUpdateForward",info:{link:e}}))},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.t,n=e.className,i=this.state.anchorEl;return c.a.createElement(c.a.Fragment,null,c.a.createElement(f.a,{className:t.iconButton+" "+n,"aria-label":"Share",open:Boolean(i),onClick:this.handleMenuClick},c.a.createElement(Nt.a,null)),c.a.createElement(At.a,{id:"attach-menu",anchorEl:i,open:Boolean(i),getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:this.handleClose},c.a.createElement(zt.a,{onClick:this.handleCopyLink},c.a.createElement(Ht.a,null,c.a.createElement(Lt.a,null)),c.a.createElement(Bt.a,{inset:!0,primary:a("CopyLink")})),c.a.createElement(zt.a,{onClick:this.handleShare},c.a.createElement(Ht.a,null,c.a.createElement(Dt.a,null)),c.a.createElement(Bt.a,{inset:!0,primary:a("StickersShare")}))))}}]),t}(c.a.Component),qt=Object(S.a)(C()(function(e){return{close:{padding:e.spacing.unit/2}}},{withTheme:!0}),Object(O.c)(),_t.withSnackbar)(Wt),Kt=(a(707),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).handleUpdateInstalledStickerSets=function(e){var t=Ut.a.stickerSet;a.setState({stickerSet:t})},a.handleClientUpdateStickerSet=function(e){var t=e.stickerSet;if(a.setState({stickerSet:t}),t){var n=Ge.a.getStore();Object(Ve.r)(n,t)}},a.handleClose=function(){G.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:null})},a.handleDone=function(){var e=a.state.stickerSet;if(e){var t=e.is_installed;G.a.send({"@type":"changeStickerSet",set_id:e.id,is_installed:!t}),a.handleClose()}},a.loadPreviewContent=function(e){var t=a.state.stickerSet.stickers.find(function(t){return t.sticker.id===e});if(t){var n=Ge.a.getStore();Object(Ve.q)(n,t,null),a.getNeighborStickers(e).forEach(function(e){Object(Ve.q)(n,e,null)})}},a.getNeighborStickers=function(e){var t=a.state.stickerSet;if(!t)return[];var n=t.stickers;if(!n)return[];var i=[],r=n.findIndex(function(t){return t.sticker.id===e});if(-1===r)return[];var s=Math.floor(r/4),o=r%4,l=s-1,c=s+1,d=o-1,u=o+1;return l>=0&&(d>=0&&i.push(4*l+d),i.push(4*l+o),u<4&&i.push(4*l+u)),d>=0&&i.push(4*s+d),u<4&&i.push(4*s+u),c<Math.ceil(n.length/4)&&(d>=0&&i.push(4*c+d),i.push(4*c+o),u<4&&i.push(4*c+u)),i.map(function(e){return n[e]})},a.handleMouseOver=function(e){var t=Number(e.target.dataset.stickerId);t&&a.mouseDown&&(a.setState({stickerId:t}),a.loadPreviewContent(t))},a.handleMouseDown=function(e){var t=Number(e.target.dataset.stickerId);if(t)return a.setState({stickerId:t}),a.loadPreviewContent(t),a.mouseDown=!0,document.addEventListener("mouseup",a.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1},a.handleMouseUp=function(){a.setState({stickerId:0}),a.mouseDown=!1,document.removeEventListener("mouseup",a.handleMouseUp)},a.state={stickerSet:Ut.a.stickerSet,stickerId:0},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.state,i=n.stickerSet,r=n.stickerId;return i!==t.stickerSet||r!==t.stickerId}},{key:"componentDidMount",value:function(){Ut.a.on("clientUpdateStickerSet",this.handleClientUpdateStickerSet),Ut.a.on("updateInstalledStickerSets",this.handleUpdateInstalledStickerSets)}},{key:"componentWillUnmount",value:function(){Ut.a.removeListener("clientUpdateStickerSet",this.handleClientUpdateStickerSet),Ut.a.removeListener("updateInstalledStickerSets",this.handleUpdateInstalledStickerSets)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.classes,n=this.state,i=n.stickerSet,r=n.stickerId;if(!i)return null;var s=i.title,o=i.stickers,l=i.emojis,d=i.is_installed,p=o.map(function(e){return c.a.createElement("div",{className:"sticker-set-dialog-item",key:e.sticker.id,"data-sticker-id":e.sticker.id,style:{width:76,height:76}},c.a.createElement(gt.a,{key:e.sticker.id,className:"sticker-set-dialog-item-sticker",sticker:e,displaySize:ye.T,blur:!1}),c.a.createElement("div",{className:"sticker-set-dialog-item-emoji"},e.emoji))}),m=o.findIndex(function(e){return e.sticker.id===r}),g=-1!==m?o[m]:null,f=-1!==m?l[m].emojis.join(" "):null;return c.a.createElement(M.a,{className:a.dialogRoot,open:!0,transitionDuration:0,onClose:this.handleClose,"aria-labelledby":"sticker-set-dialog-title-text",classes:{paper:a.paperRoot}},c.a.createElement(D.a,{id:"sticker-set-dialog-title-text",className:u()(a.dialogTitleRoot,Object(h.a)({},a.disablePointerEvents,Boolean(g))),disableTypography:!0},c.a.createElement(kt.a,{variant:"h6",className:a.typographyRoot,noWrap:!0},s),c.a.createElement(qt,{className:a.shareButtonRoot})),c.a.createElement(L.a,{classes:{root:a.contentRoot},onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown},p),c.a.createElement(_.a,{className:u()(Object(h.a)({},a.disablePointerEvents,Boolean(g)))},c.a.createElement(E.a,{color:"primary",onClick:this.handleClose},t("Cancel")),c.a.createElement(E.a,{color:"primary",onClick:this.handleDone},t(d?"Remove":"Add"))),Boolean(g)&&c.a.createElement("div",{className:"sticker-set-dialog-preview"},c.a.createElement("div",{className:"sticker-set-dialog-preview-emoji"},f),c.a.createElement(gt.a,{sticker:g,displaySize:ye.S})))}}]),t}(c.a.Component)),Jt=Object(S.a)(C()(function(e){return{contentRoot:{display:"flex",flexWrap:"wrap",maxHeight:480,padding:"0 12px 24px",background:"transparent"},paperRoot:{width:344},dialogTitleRoot:{display:"flex",flexDirection:"row",alignItems:"center"},dialogRoot:{color:e.palette.text.primary},shareButtonRoot:{margin:"-24px -12px -24px 0"},typographyRoot:{flexGrow:1,flexShrink:1},disablePointerEvents:{pointerEvents:"none"}}}),Object(O.c)())(Kt),$t=function(e){function t(){var e,a;Object(n.a)(this,t);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={hint:null,stickerId:0},a.onClientUpdateStickersHint=function(e){var t=e.hint;if(a.setState({hint:t,stickerId:0}),t){var n=Ge.a.getStore(),i=t.stickers;Object(Ve.s)(n,i.stickers)}},a.handleSend=function(e){e&&a.mouseDownStickerId===e.sticker.id&&(console.log("Match.sendSticker",e),G.a.clientUpdate({"@type":"clientUpdateStickerSend",sticker:e}))},a.loadPreviewContent=function(e){var t=a.state.hint.stickers.stickers,n=t.find(function(t){return t.sticker.id===e});if(n){var i=Ge.a.getStore();Object(Ve.q)(i,n,null),a.getNeighborStickers(e,t,8).forEach(function(e){Object(Ve.q)(i,e,null)})}},a.getNeighborStickers=function(e,t,a){if(!t)return[];var n=[],i=t.findIndex(function(t){return t.sticker.id===e});if(-1===i)return[];var r=Math.floor(i/a),s=i%a,o=r-1,l=r+1,c=s-1,d=s+1;return o>=0&&(c>=0&&n.push(a*o+c),n.push(a*o+s),d<a&&n.push(a*o+d)),c>=0&&n.push(a*r+c),d<a&&n.push(a*r+d),l<Math.ceil(t.length/a)&&(c>=0&&n.push(a*l+c),n.push(a*l+s),d<a&&n.push(a*l+d)),n.map(function(e){return t[e]})},a.handleMouseOver=function(e){var t=Number(e.target.dataset.stickerId);t&&a.mouseDown&&(a.mouseDownStickerId!==t&&(a.mouseDownStickerId=null),a.setState({stickerId:t}),a.loadPreviewContent(t))},a.handleMouseDown=function(e){var t=Number(e.target.dataset.stickerId);if(t){a.mouseDownStickerId=t;var n=Date.now();return a.setState({stickerId:t,timestamp:n,showPreview:!1}),setTimeout(function(){a.state.timestamp===n&&a.setState({showPreview:!0})},500),a.loadPreviewContent(t),a.mouseDown=!0,document.addEventListener("mouseup",a.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1}},a.handleMouseUp=function(){a.setState({stickerId:0,timestamp:0,showPreview:!1}),a.mouseDown=!1,document.removeEventListener("mouseup",a.handleMouseUp)},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Ut.a.on("clientUpdateStickersHint",this.onClientUpdateStickersHint)}},{key:"componentWillUnmount",value:function(){Ut.a.removeListener("clientUpdateStickersHint",this.onClientUpdateStickersHint)}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.hint,i=a.stickerId,r=a.showPreview;if(!n)return null;var s=n.stickers;if(!s)return null;var o=s.stickers;if(!o.length)return null;var l=o.map(function(t){return c.a.createElement("div",{className:"sticker-set-dialog-item",key:t.sticker.id,"data-sticker-id":t.sticker.id,style:{width:76,height:76},onClick:function(){return e.handleSend(t)}},c.a.createElement(gt.a,{key:t.sticker.id,className:"sticker-set-dialog-item-sticker",sticker:t,displaySize:ye.T,blur:!1}))}),d=o.findIndex(function(e){return e.sticker.id===i}),p=-1!==d?o[d]:null;-1!==d&&p.emoji;return c.a.createElement("div",{className:u()("stickers-hint",t.borderColor,t.root),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown},l,Boolean(p)&&r&&c.a.createElement("div",{className:"sticker-set-dialog-preview"},c.a.createElement(gt.a,{sticker:p,displaySize:ye.S})))}}]),t}(c.a.Component),Qt=C()(function(e){return Object(m.a)({root:{background:"dark"===e.palette.type?e.palette.background.default:"#FFFFFF"}},Object(F.b)(e))})($t),Xt=(a(708),Object.freeze({NONE:"NONE",SCROLL_TO_BOTTOM:"SCROLL_TO_BOTTOM",SCROLL_TO_UNREAD:"SCROLL_TO_UNREAD",SCROLL_TO_MESSAGE:"SCROLL_TO_MESSAGE",KEEP_SCROLL_POSITION:"KEEP_SCROLL_POSITION"})),Yt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onClientUpdateMediaActive=function(e){var t=a.listRef.current,n=t.offsetHeight,i=t.scrollTop;a.setState({playerOpened:!0},function(){t.scrollTop===i&&(t.scrollTop+=Math.abs(n-t.offsetHeight))})},a.onClientUpdateMediaEnding=function(e){var t=a.listRef.current;a.prevOffsetHeight=t.offsetHeight,a.prevScrollTop=t.scrollTop},a.onClientUpdateMediaEnd=function(e){var t=a.listRef.current;a.setState({playerOpened:!1},function(){t.scrollTop===a.prevScrollTop&&(t.scrollTop-=Math.abs(a.prevOffsetHeight-t.offsetHeight))})},a.onClientUpdateSelection=function(e){a.setState({selectionActive:V.a.selectedItems.size>0,scrollBehavior:Xt.KEEP_SCROLL_POSITION})},a.onClientUpdateClearHistory=function(e){a.props.chatId===e.chatId&&a.setState({clearHistory:e.inProgress})},a.onUpdateMessageContent=function(e){var t=a.props.chatId,n=a.state.history,i=e.chat_id,r=e.message_id;if(t===i&&-1!==n.findIndex(function(e){return e.id===r})){var s=V.a.get(i,r);if(!s)return;var o=Ge.a.getStore();Object(Ve.o)(o,[s])}},a.onUpdateChatLastMessage=function(e){a.props.chatId;e.chat_id},a.onUpdateMessageSendSucceeded=function(e){var n=e.message,i=e.old_message_id;if(a.props.chatId===n.chat_id){var r=!1;switch(n.content["@type"]){case"messagePoll":r=!0}if(r){var s=Xt.NONE,o=a.listRef.current;o.scrollTop===o.scrollHeight-o.offsetHeight?s=Xt.SCROLL_TO_BOTTOM:n.is_outgoing&&(s=Xt.SCROLL_TO_BOTTOM),console.log("SCROLL MessagesList.onUpdateMessageSendSucceeded scrollBehavior="+s),a.replaceMessage(i,n,s);var l=Ge.a.getStore();Object(Ve.o)(l,[n]),t.viewMessages([n])}}},a.onUpdateNewMessage=function(e){if(a.completed){var n=e.message;if(a.props.chatId===n.chat_id){var i=Xt.NONE,r=a.listRef.current;r.scrollTop===r.scrollHeight-r.offsetHeight?i=Xt.SCROLL_TO_BOTTOM:n.is_outgoing&&(i=Xt.SCROLL_TO_BOTTOM);var s=[n];console.log("SCROLL MessagesList.onUpdateNewMessage scrollBehavior="+i),a.insertAfter(a.filterMessages(s),i);var o=Ge.a.getStore();Object(Ve.o)(o,s),t.viewMessages(s)}}},a.onUpdateDeleteMessages=function(e){a.props.chatId===e.chat_id&&e.is_permanent&&a.deleteHistory(e.message_ids)},a.updateItemsInView=function(){if(a.messages){for(var e=new Map,t=Object(De.p)(a.listRef,a.itemsRef),n=0;n<t.length;n++){var i=a.messages[t[n]];if(i){var r=i.props,s=r.chatId,o=r.messageId,l="".concat(s,"_").concat(o);e.set(l,l)}}G.a.clientUpdate({"@type":"clientUpdateMessagesInView",messages:e})}},a.loadIncompleteHistory=function(){var e=Object(Qe.a)($e.a.mark(function e(t){var n,i,r;return $e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=5,i=t&&t.messages.length>0&&t.messages.length<ye.l,r=0;case 3:if(!(r<n&&i)){e.next=11;break}return e.next=6,a.onLoadNext();case 6:t=e.sent,i=t&&t.messages.length>0&&t.messages.length<ye.l;case 8:r++,e.next=3;break;case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onLoadNext=Object(Qe.a)($e.a.mark(function e(){var n,i,r,s,o;return $e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.props.chatId){e.next=3;break}return e.abrupt("return");case 3:if(!a.loading){e.next=5;break}return e.abrupt("return");case 5:if(!a.loadMigratedHistory){e.next=8;break}return a.onLoadMigratedHistory(),e.abrupt("return");case 8:return i=0,a.state.history&&a.state.history.length>0&&(i=a.state.history[0].id),a.loading=!0,r=a.sessionId,e.next=14,G.a.send({"@type":"getChatHistory",chat_id:n,from_message_id:i,offset:0,limit:ye.l}).finally(function(){a.loading=!1});case 14:if(s=e.sent,r===a.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(a.props.chatId===n){e.next=19;break}return e.abrupt("return");case 19:return V.a.setItems(s.messages),s.messages.reverse(),a.insertBefore(a.filterMessages(s.messages),function(){s.messages.length||a.onLoadMigratedHistory()}),o=Ge.a.getStore(),Object(Ve.o)(o,s.messages),t.viewMessages(s.messages),e.abrupt("return",s);case 26:case"end":return e.stop()}},e)})),a.filterMessages=function(e){return e.filter(function(e){return"messageChatUpgradeTo"!==e.content["@type"]})},a.onLoadMigratedHistory=Object(Qe.a)($e.a.mark(function e(){var n,i,r,s,o,l,c,d;return $e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.props.chatId){e.next=3;break}return e.abrupt("return");case 3:if(!a.loading){e.next=5;break}return e.abrupt("return");case 5:if(i=Object(A.G)(n)){e.next=8;break}return e.abrupt("return");case 8:if(r=Q.a.getFullInfo(i)){e.next=11;break}return e.abrupt("return");case 11:if(r.upgraded_from_basic_group_id){e.next=13;break}return e.abrupt("return");case 13:return a.loadMigratedHistory=!0,e.next=16,G.a.send({"@type":"createBasicGroupChat",basic_group_id:r.upgraded_from_basic_group_id});case 16:if(s=e.sent){e.next=19;break}return e.abrupt("return");case 19:return o=0,a.state.history&&a.state.history.length>0&&a.state.history[0].chat_id===s.id&&(o=a.state.history[0].id),a.loading=!0,l=a.sessionId,e.next=25,G.a.send({"@type":"getChatHistory",chat_id:s.id,from_message_id:o,offset:0,limit:ye.l}).finally(function(){a.loading=!1});case 25:if(c=e.sent,l===a.sessionId){e.next=28;break}return e.abrupt("return");case 28:if(a.props.chatId===n){e.next=30;break}return e.abrupt("return");case 30:V.a.setItems(c.messages),c.messages.reverse(),a.insertBefore(a.filterMessages(c.messages)),d=Ge.a.getStore(),Object(Ve.o)(d,c.messages),t.viewMessages(c.messages);case 36:case"end":return e.stop()}},e)})),a.onLoadPrevious=Object(Qe.a)($e.a.mark(function e(){var n,i,r,s,o,l;return $e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.props.chatId,i=K.a.get(n)){e.next=4;break}return e.abrupt("return");case 4:if(!a.loading){e.next=6;break}return e.abrupt("return");case 6:if(!a.completed){e.next=8;break}return e.abrupt("return");case 8:return r=0,a.state.history&&a.state.history.length>0&&(r=a.state.history[a.state.history.length-1].id),a.loading=!0,s=a.sessionId,e.next=14,G.a.send({"@type":"getChatHistory",chat_id:n,from_message_id:r,offset:-ye.l-1,limit:ye.l+1}).finally(function(){a.loading=!1});case 14:if(o=e.sent,s===a.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(a.props.chatId===n){e.next=19;break}return e.abrupt("return");case 19:return i.last_message?a.completed=o.messages.length>0&&i.last_message.id===o.messages[0].id:a.completed=!0,Object(Be.a)(o,a.state.history),V.a.setItems(o.messages),o.messages.reverse(),console.log("SCROLL MessagesList.onLoadPrevious scrollBehavior=NONE"),a.insertAfter(a.filterMessages(o.messages),Xt.NONE),l=Ge.a.getStore(),Object(Ve.o)(l,o.messages),t.viewMessages(o.messages),e.abrupt("return",o);case 29:case"end":return e.stop()}},e)})),a.handleScroll=function(){a.updateItemsInView();var e=a.listRef.current;if(a.suppressHandleScroll)return console.log("SCROLL HANDLESCROLL suppressHandleScroll"),void(a.suppressHandleScroll=!1);a.suppressHandleScrollOnSelectChat?console.log("SCROLL HANDLESCROLL suppressHandleScrollOnSelectChat"):e.scrollTop<=0?(console.log("SCROLL HANDLESCROLL onLoadNext"),a.onLoadNext()):e.scrollTop+e.offsetHeight===e.scrollHeight&&(console.log("SCROLL HANDLESCROLL onLoadPrevious"),a.onLoadPrevious())},a.handleScrollBehavior=function(e){var t=a.props,n=t.chatId,i=(t.messageId,a.state),r=i.scrollBehavior,s=i.history,o=e.scrollTop,l=e.scrollHeight,c=e.offsetHeight;if(console.log("SCROLL HANDLESCROLLBEHAVIOR \\\n            scrollBehavior=".concat(r," \\\n            previousScrollTop=").concat(o," \\\n            previousScrollHeight=").concat(l," \\\n            previousOffsetHeight=").concat(c," \\\n            chatId=").concat(n)),r===Xt.NONE);else if(r===Xt.SCROLL_TO_BOTTOM)a.scrollToBottom();else if(r===Xt.SCROLL_TO_MESSAGE)a.scrollToMessage();else if(r===Xt.SCROLL_TO_UNREAD){var d=a.listRef.current;console.log("SCROLL SCROLL_TO_UNREAD before \\\n                list.scrollTop=".concat(d.scrollTop," \\\n                list.offsetHeight=").concat(d.offsetHeight," \\\n                list.scrollHeight=").concat(d.scrollHeight," \\\n                chatId=").concat(n));for(var u=!1,p=0;p<s.length;p++){var h=a.itemsMap.get(p),m=Pe.findDOMNode(h);if(m&&h.props.showUnreadSeparator){d.scrollTop=m.offsetTop,u=!0;break}}u||a.scrollToBottom(),console.log("SCROLL SCROLL_TO_UNREAD after \\\n                list.scrollTop=".concat(d.scrollTop," \\\n                list.offsetHeight=").concat(d.offsetHeight," \\\n                list.scrollHeight=").concat(d.scrollHeight," \\\n                chatId=").concat(n))}else if(r===Xt.KEEP_SCROLL_POSITION){var g=a.listRef.current;console.log("SCROLL KEEP_SCROLL_POSITION before \\\n                list.scrollTop=".concat(g.scrollTop," \\\n                list.offsetHeight=").concat(g.offsetHeight," \\\n                list.scrollHeight=").concat(g.scrollHeight," \\\n                chatId=").concat(n)),g.scrollTop=o+(g.scrollHeight-l),console.log("SCROLL KEEP_SCROLL_POSITION after \\\n                list.scrollTop=".concat(g.scrollTop," \\\n                list.offsetHeight=").concat(g.offsetHeight," \\\n                list.scrollHeight=").concat(g.scrollHeight," \\\n                chatId=").concat(n))}},a.scrollToMessage=function(){var e=a.props,t=e.chatId,n=e.messageId,i=a.state.history,r=a.listRef.current;console.log("SCROLL SCROLL_TO_MESSAGE message_id=".concat(n," before \\\n            list.scrollTop=").concat(r.scrollTop," \\\n            list.offsetHeight=").concat(r.offsetHeight," \\\n            list.scrollHeight=").concat(r.scrollHeight," \\\n            chatId=").concat(t));for(var s=!1,o=0;o<i.length;o++){var l=a.itemsMap.get(o),c=Pe.findDOMNode(l);if(c&&l.props.messageId===n){r.scrollTop=c.offsetTop-r.offsetHeight/2,s=!0;break}}s||a.scrollToBottom(),console.log("SCROLL SCROLL_TO_MESSAGE message_id=".concat(n," after \\\n            list.scrollTop=").concat(r.scrollTop," \\\n            list.offsetHeight=").concat(r.offsetHeight," \\\n            list.scrollHeight=").concat(r.scrollHeight," \\\n            chatId=").concat(t))},a.scrollToBottom=function(){a.suppressHandleScroll=!0;var e=a.listRef.current;console.log("SCROLL SCROLL_TO_BOTTOM before \\\n            list.scrollHeight=".concat(e.scrollHeight," \\\n            list.offsetHeight=").concat(e.offsetHeight," \\\n            list.scrollTop=").concat(e.scrollTop," \\\n            chatId=").concat(a.props.chatId)),e.scrollHeight-e.offsetHeight!==e.scrollTop?(e.scrollTop=e.scrollHeight-e.offsetHeight,console.log("SCROLL SCROLL_TO_BOTTOM after \\\n                list.scrollTop=".concat(e.scrollTop," \\\n                list.offsetHeight=").concat(e.offsetHeight," \\\n                list.scrollHeight=").concat(e.scrollHeight," \\\n                suppressHandleScroll=").concat(a.suppressHandleScroll," \\\n                chatId=").concat(a.props.chatId))):console.log("SCROLL SCROLL_TO_BOTTOM after(already bottom) \\\n                list.scrollTop=".concat(e.scrollTop," \\\n                list.offsetHeight=").concat(e.offsetHeight," \\\n                list.scrollHeight=").concat(e.scrollHeight," \\\n                suppressHandleScroll=").concat(a.suppressHandleScroll," \\\n                chatId=").concat(a.props.chatId))},a.scrollToStart=Object(Qe.a)($e.a.mark(function e(){var n,i,r,s,o,l;return $e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.props.chatId,i=K.a.get(n)){e.next=4;break}return e.abrupt("return");case 4:return a.sessionId=Date.now(),a.loading=!1,a.completed=!1,0,0,r=ye.l,s=a.sessionId,e.next=13,G.a.send({"@type":"getChatHistory",chat_id:i.id,from_message_id:0,offset:0,limit:r});case 13:if(o=e.sent,s===a.sessionId){e.next=16;break}return e.abrupt("return");case 16:if(a.props.chatId===n){e.next=18;break}return e.abrupt("return");case 18:i.last_message?a.completed=o.messages.length>0&&i.last_message.id===o.messages[0].id:a.completed=!0,V.a.setItems(o.messages),o.messages.reverse(),0,console.log("[MessagesList] separator_message_id=0"),a.replace(0,o.messages,Xt.SCROLL_TO_BOTTOM),l=Ge.a.getStore(),Object(Ve.o)(l,o.messages),Object(Ve.l)(l,[n]),t.viewMessages(o.messages),a.loadIncompleteHistory(o);case 29:case"end":return e.stop()}},e)})),a.handleListDragEnter=function(e){e.preventDefault(),e.stopPropagation();var t=a.props.chatId;Object(A.d)(t)&&z.a.setDragging(!0)},console.log("MessagesList.ctor chat_id=".concat(e.chatId," message_id=").concat(e.messageId)),a.sessionId=Date.now(),a.state={prevChatId:0,prevMessageId:null,playerOpened:!1,history:[],clearHistory:!1,selectionActive:!1,scrollBehavior:Xt.NONE,separatorMessageId:0},a.listRef=c.a.createRef(),a.itemsRef=c.a.createRef(),a.itemsMap=new Map,a.updateItemsInView=Object(De.t)(a.updateItemsInView,500),a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"getSnapshotBeforeUpdate",value:function(e,t){var a=this.props.chatId,n=this.listRef.current,i={scrollTop:n.scrollTop,scrollHeight:n.scrollHeight,offsetHeight:n.offsetHeight};return console.log("SCROLL GETSNAPSHOTBEFOREUPDATE \\\n            list.scrollTop=".concat(n.scrollTop," \\\n            list.scrollHeight=").concat(n.scrollHeight," \\\n            list.offsetHeight=").concat(n.offsetHeight," \\\n            chatId=").concat(a)),i}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props,i=n.chatId,r=n.messageId,s=this.listRef.current;console.log("MessagesList.componentDidUpdate chat_id=".concat(i," message_id=").concat(r," \\\n            prev_chat_id=").concat(e.chatId," prev_message_id=").concat(e.messageId," \\\n            list.scrollTop=").concat(s.scrollTop," \\\n            list.scrollHeight=").concat(s.scrollHeight," \\\n            list.offsetHeight=").concat(s.offsetHeight)),e.chatId!==i||e.messageId!==r?this.handleSelectChat(i,e.chatId,r,e.messageId):this.handleScrollBehavior(a)}},{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,i=a.messageId,r=a.theme,s=this.state,o=s.playerOpened,l=s.history,c=s.dragging,d=s.clearHistory,u=s.selectionActive;return e.theme!==r||(e.chatId!==n||(e.messageId!==i||(t.playerOpened!==o||(t.history!==l||(t.dragging!==c||(t.clearHistory!==d||t.selectionActive!==u))))))}},{key:"componentDidMount",value:function(){var e=this.props.chatId;this.handleSelectChat(e,0),V.a.on("updateNewMessage",this.onUpdateNewMessage),V.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),V.a.on("updateMessageContent",this.onUpdateMessageContent),V.a.on("updateMessageSendSucceeded",this.onUpdateMessageSendSucceeded),V.a.on("clientUpdateMessageSelected",this.onClientUpdateSelection),V.a.on("clientUpdateClearSelection",this.onClientUpdateSelection),K.a.on("updateChatLastMessage",this.onUpdateChatLastMessage),K.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),Ce.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ce.b.on("clientUpdateMediaEnding",this.onClientUpdateMediaEnding),Ce.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"componentWillUnmount",value:function(){V.a.removeListener("updateNewMessage",this.onUpdateNewMessage),V.a.removeListener("updateDeleteMessages",this.onUpdateDeleteMessages),V.a.removeListener("updateMessageContent",this.onUpdateMessageContent),V.a.removeListener("updateMessageSendSucceeded",this.onUpdateMessageSendSucceeded),V.a.removeListener("clientUpdateMessageSelected",this.onClientUpdateSelection),V.a.removeListener("clientUpdateClearSelection",this.onClientUpdateSelection),K.a.removeListener("updateChatLastMessage",this.onUpdateChatLastMessage),K.a.removeListener("clientUpdateClearHistory",this.onClientUpdateClearHistory),Ce.b.removeListener("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ce.b.removeListener("clientUpdateMediaEnding",this.onClientUpdateMediaEnding),Ce.b.removeListener("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"handleSelectChat",value:function(){var e=Object(Qe.a)($e.a.mark(function e(a,n,i,r){var s,o,l,c,d,u,p,h,m,g,f,v,b,y=this;return $e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=K.a.get(a),o=K.a.get(n),this.sessionId=Date.now(),this.loading=!1,this.completed=!1,this.loadMigratedHistory=!1,this.suppressHandleScrollOnSelectChat=!0,!s){e.next=49;break}return G.a.send({"@type":"openChat",chat_id:s.id}),l=!i&&s.unread_count>0,c=l&&s.unread_count>1?s.last_read_inbox_message_id:i||0,d=l&&s.unread_count>1||i?-1-ye.l:0,u=l&&s.unread_count>1||i?2*ye.l:ye.l,p=this.sessionId,e.next=16,G.a.send({"@type":"getChatHistory",chat_id:s.id,from_message_id:c,offset:d,limit:u});case 16:if(h=e.sent,p===this.sessionId){e.next=19;break}return e.abrupt("return");case 19:if(s.last_message?this.completed=h.messages.length>0&&s.last_message.id===h.messages[0].id:this.completed=!0,V.a.setItems(h.messages),h.messages.reverse(),m=Number.MAX_VALUE,!(s&&s.unread_count>1)){e.next=35;break}g=h.messages.length-1;case 25:if(!(g>=0)){e.next=35;break}if(f=h.messages[g].id,!(!h.messages[g].is_outgoing&&f>s.last_read_inbox_message_id&&f<m)){e.next=31;break}m=f,e.next=32;break;case 31:return e.abrupt("break",35);case 32:g--,e.next=25;break;case 35:m=m===Number.MAX_VALUE?0:m,console.log("[MessagesList] separator_message_id="+m),v=Xt.SCROLL_TO_BOTTOM,i?v=Xt.SCROLL_TO_MESSAGE:l&&m&&(v=Xt.SCROLL_TO_UNREAD),this.replace(m,h.messages,v,function(){y.suppressHandleScrollOnSelectChat=!1,i&&Object(ze.a)(a,i)}),b=Ge.a.getStore(),Object(Ve.o)(b,h.messages),Object(Ve.l)(b,[a]),Object(Ve.m)(b,a),t.viewMessages(h.messages),this.loadIncompleteHistory(h),Object(A.k)(s.id),e.next=50;break;case 49:this.replace(0,[],Xt.SCROLL_TO_BOTTOM,function(){return y.suppressHandleScrollOnSelectChat=!1});case 50:o&&G.a.send({"@type":"closeChat",chat_id:o.id});case 51:case"end":return e.stop()}},e,this)}));return function(t,a,n,i){return e.apply(this,arguments)}}()},{key:"cancelLoadMessageContents",value:function(e){for(var t=e.length-1;t>=0;t--){var a=e[t];if(a&&a.content)switch(a.content["@type"]){case"messagePhoto":var n=this.getMessagePhoto(a),i=Object(Ke.a)(n,2),r=i[0];if(i[1])Object(De.j)(a.content.photo.sizes).blob||Ge.a.cancelGetRemoteFile(r,a);break;case"messageSticker":var s=this.getMessageSticker(a),o=Object(Ke.a)(s,2),l=o[0];if(o[1])a.content.sticker.sticker.blob||Ge.a.cancelGetRemoteFile(l,a)}}}},{key:"replace",value:function(e,t,a,n){this.setState({separatorMessageId:e,history:t,scrollBehavior:a},n)}},{key:"insertBefore",value:function(e,t){0!==e.length?this.setState({history:e.concat(this.state.history),scrollBehavior:Xt.KEEP_SCROLL_POSITION},t):t&&t()}},{key:"replaceMessage",value:function(e,t,a,n){t&&this.setState({history:this.state.history.filter(function(t){return t.id!==e}).concat([t]),scrollBehavior:a},n)}},{key:"insertAfter",value:function(e,t,a){0!==e.length&&this.setState({history:this.state.history.concat(e),scrollBehavior:t},a)}},{key:"deleteHistory",value:function(e,t){var a=this.state.history;if(0!==a.length){var n=new Map(e.map(function(e){return[e,e]}));this.setState({history:a.filter(function(e){return!n.has(e.id)}),scrollBehavior:Xt.SCROLL_TO_BOTTOM},t)}}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.history,i=a.separatorMessageId,r=a.clearHistory,s=a.selectionActive;return console.log("MessagesList.render clearHistory=".concat(r),n),this.itemsMap.clear(),this.messages=r?null:n.map(function(t,a){return Object(Ct.b)(t)?c.a.createElement(It,{key:"chat_id=".concat(t.chat_id," message_id=").concat(t.id),ref:function(t){return e.itemsMap.set(a,t)},chatId:t.chat_id,messageId:t.id,showUnreadSeparator:i===t.id}):c.a.createElement(yt,{key:"chat_id=".concat(t.chat_id," message_id=").concat(t.id),ref:function(t){return e.itemsMap.set(a,t)},chatId:t.chat_id,messageId:t.id,showTitle:!0,sendingState:t.sending_state,showUnreadSeparator:i===t.id})}),c.a.createElement("div",{className:u()(t.background,"messages-list",{"messages-list-selection-active":s}),onDragEnter:this.handleListDragEnter},c.a.createElement("div",{ref:this.listRef,className:"messages-list-wrapper",onScroll:this.handleScroll},c.a.createElement("div",{className:"messages-list-top"}),c.a.createElement("div",{ref:this.itemsRef,className:"messages-list-items"},this.messages)),c.a.createElement(Xe,null),c.a.createElement(Qt,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.chatId!==t.prevChatId||e.messageId!==t.prevMessageId?{prevChatId:e.chatId,prevMessageId:e.messageId,clearHistory:!1,selectionActive:!1,scrollBehavior:Xt.SCROLL_TO_BOTTOM,separatorMessageId:0}:null}},{key:"viewMessages",value:function(e){e&&0!==e.length&&e[0].chat_id&&G.a.send({"@type":"viewMessages",chat_id:e[0].chat_id,message_ids:e.map(function(e){return e.id})})}}]),t}(c.a.Component),Zt=C()(function(e){return{background:{background:"dark"===e.palette.type?e.palette.grey[900]:"transparent"}}},{withTheme:!0})(Yt),ea=a(513),ta=(a(709),function(e){function t(){var e,a;Object(n.a)(this,t);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={chatId:z.a.dialogChatId},a.handleClientUpdateDialogChatId=function(e){var t=e.chatId;a.setState({chatId:t})},a.handleClose=function(){G.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.state.chatId;return t.chatId!==n}},{key:"componentDidMount",value:function(){z.a.on("clientUpdateDialogChatId",this.handleClientUpdateDialogChatId)}},{key:"componentWillUnmount",value:function(){z.a.removeListener("clientUpdateDialogChatId",this.handleClientUpdateDialogChatId)}},{key:"render",value:function(){var e=this.props.classes,t=this.state.chatId;return t?c.a.createElement(M.a,{open:!0,transitionDuration:0,onClose:this.handleClose,classes:{root:e.dialogRoot,container:e.containerRoot,paper:e.paperRoot}},c.a.createElement(ea.default,{className:e.chatInfoRoot,chatId:t,popup:!0})):null}}]),t}(c.a.Component)),aa=C()(function(e){return{chatInfoRoot:{width:336},containerRoot:{alignItems:"start"},dialogRoot:{color:e.palette.text.primary,zIndex:1},paperRoot:{width:336}}})(ta),na=(a(710),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this,e))).onUpdateChatDetailsVisibility=function(e){a.forceUpdate()},a.onClientUpdateChatId=function(e){a.setState({chatId:e.nextChatId,messageId:e.nextMessageId})},a.scrollToBottom=function(){a.messagesList.scrollToBottom()},a.scrollToStart=function(){a.messagesList.scrollToStart()},a.scrollToMessage=function(){a.messagesList.scrollToMessage()},a.state={chatId:z.a.getChatId(),messageId:z.a.getMessageId(),selectedCount:0},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return t.chatId!==this.state.chatId||(t.messageId!==this.state.messageId||t.selectedCount!==this.state.selectedItems)}},{key:"componentDidMount",value:function(){z.a.on("clientUpdateChatDetailsVisibility",this.onUpdateChatDetailsVisibility),z.a.on("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"componentWillUnmount",value:function(){z.a.removeListener("clientUpdateChatDetailsVisibility",this.onUpdateChatDetailsVisibility),z.a.removeListener("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"render",value:function(){var e=this,t=this.state,a=t.chatId,n=t.messageId,i=(t.selectedCount,z.a.isChatDetailsVisible);return c.a.createElement("div",{className:u()("dialog-details",{"dialog-details-third-column":i})},c.a.createElement(qe,null),c.a.createElement(Y,{chatId:a}),c.a.createElement(Zt,{innerRef:function(t){return e.messagesList=t},chatId:a,messageId:n}),c.a.createElement(p.a,{chatId:a}),c.a.createElement(Jt,null),c.a.createElement(aa,null))}}]),t}(l.Component));t.default=na}}]);
//# sourceMappingURL=6.1d607864.chunk.js.map