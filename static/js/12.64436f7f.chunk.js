(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{427:function(e,t,a){"use strict";var n=a(396),i=a(7),r=a(10),o=a(12),l=a(11),d=a(13),c=a(0),s=a.n(c),u=a(8),h=a.n(u),p=a(6),v=a.n(p),f=(a(428),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),d=0;d<n;d++)r[d]=arguments[d];return(a=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(e){e.stopPropagation();var t=a.props,n=t.onClick;t.disabled||n(e)},a}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.checked,a=e.children,i=e.classes,r=e.disabled,o=e.title;return s.a.createElement("div",{className:h()(r?"media-viewer-footer-button-disabled":"media-viewer-footer-button",Object(n.a)({},i.checked,t)),title:o,onClick:this.handleClick},a)}}]),t}(s.a.Component));t.a=v()(function(e){return{checked:{color:e.palette.primary.main}}})(f)},428:function(e,t,a){},477:function(e,t,a){},478:function(e,t,a){"use strict";var n=a(7),i=a(10),r=a(12),o=a(11),l=a(13),d=a(0),c=a.n(d),s=a(8),u=a.n(s),h=(a(479),function(e){function t(){var e,a;Object(n.a)(this,t);for(var i=arguments.length,l=new Array(i),d=0;d<i;d++)l[d]=arguments[d];return(a=Object(r.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(l)))).handleClick=function(e){e.stopPropagation();var t=a.props,n=t.disabled,i=t.onClick;n||i(e)},a}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,a=e.grow,n=e.children,i=u()(t?"media-viewer-button-disabled":"media-viewer-button",{grow:a});return c.a.createElement("div",{className:i,onClick:this.handleClick},n)}}]),t}(c.a.Component));t.a=h},479:function(e,t,a){},480:function(e,t,a){"use strict";var n=a(7),i=a(10),r=a(12),o=a(11),l=a(13),d=a(0),c=a.n(d),s=(a(481),function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.subtitle;return c.a.createElement("div",{className:"media-viewer-footer-text"},c.a.createElement("div",{className:"media-viewer-footer-text-wrapper"},c.a.createElement("span",null,t),Boolean(a)&&c.a.createElement("span",null,"\xa0",a)))}}]),t}(c.a.Component));t.a=s},481:function(e,t,a){},482:function(e,t,a){"use strict";var n=a(7),i=a(10),r=a(12),o=a(11),l=a(13),d=a(0),c=a.n(d),s=a(483),u=a.n(s),h=a(427),p=a(392),v=(a(428),{padding:20,color:"white"}),f=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).onClientUpdateMediaBlob=function(e){var n=a.state.fileId;n===e.fileId&&a.setState({disabled:t.saveDisabled(n)})},a.handleClick=function(e){e.stopPropagation();var t=a.props.onClick;a.state.disabled||t(e)};var i=e.fileId;return a.state={prevPropsFileId:i,fileId:i,disabled:t.saveDisabled(i)},a}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){p.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),p.a.on("clientUpdateChatBlob",this.onClientUpdateMediaBlob),p.a.on("clientUpdateDocumentBlob",this.onClientUpdateMediaBlob),p.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),p.a.on("clientUpdateUserBlob",this.onClientUpdateMediaBlob),p.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob)}},{key:"componentWillUnmount",value:function(){p.a.removeListener("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),p.a.removeListener("clientUpdateChatBlob",this.onClientUpdateMediaBlob),p.a.removeListener("clientUpdateDocumentBlob",this.onClientUpdateMediaBlob),p.a.removeListener("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),p.a.removeListener("clientUpdateUserBlob",this.onClientUpdateMediaBlob),p.a.removeListener("clientUpdateVideoBlob",this.onClientUpdateMediaBlob)}},{key:"render",value:function(){var e=this.props.title,t=this.state.disabled;return c.a.createElement(h.a,{disabled:t,title:e,onClick:this.handleClick},c.a.createElement(u.a,{style:v}))}}],[{key:"getDerivedStateFromProps",value:function(e,a){var n=e.fileId;return n!==a.prevPropsFileId?{prevPropsFileId:n,fileId:n,disabled:t.saveDisabled(n)}:null}}]),t}(c.a.Component);f.saveDisabled=function(e){return!Boolean(p.a.getBlob(e))},t.a=f},483:function(e,t,a){"use strict";var n=a(97);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(0)),r=(0,n(a(119)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"GetApp");t.default=r},484:function(e,t,a){"use strict";var n=a(97);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(0)),r=(0,n(a(119)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"NavigateBefore");t.default=r},485:function(e,t,a){"use strict";var n=a(97);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(0)),r=(0,n(a(119)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"NavigateNext");t.default=r},486:function(e,t,a){"use strict";var n=a(97);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(0)),r=(0,n(a(119)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"Delete");t.default=r},511:function(e,t,a){},727:function(e,t,a){"use strict";a.r(t);var n=a(14),i=a.n(n),r=a(24),o=a(7),l=a(10),d=a(12),c=a(11),s=a(13),u=a(0),h=a.n(u),p=a(53),v=a(402),f=a.n(v),m=a(485),b=a.n(m),C=a(484),g=a.n(C),O=a(454),j=a.n(O),w=a(486),y=a.n(w),I=a(482),k=a(478),E=a(480),M=a(427),U=a(410),B=a(391),P=a(27),N=a(392),x=(a(511),function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(d.a)(this,Object(c.a)(t).call(this,e))).onClientUpdateChatBlob=function(e){var t=a.props,n=t.chatId,i=t.photo;if(n===e.chatId&&i.big.id===e.fileId){var r=N.a.get(e.fileId)||a.state.file;a.setState({file:r})}},a.onClientUpdateUserBlob=function(e){var t=a.props,n=t.chatId,i=t.photo;if(Object(B.v)(n)===e.userId&&i.big.id===e.fileId){var r=N.a.get(e.fileId)||a.state.file;a.setState({file:r})}},a.handleContentClick=function(e){e&&e.stopPropagation(),a.props.onClick(e)};var n=a.props,i=n.chatId,r=n.photo,l=r.big;return l=N.a.get(l.id)||l,a.state={prevChatId:i,prevPhoto:r,width:P.O,height:P.O,file:l},a}return Object(s.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){N.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob),N.a.on("clientUpdateUserBlob",this.onClientUpdateUserBlob)}},{key:"componentWillUnmount",value:function(){N.a.removeListener("clientUpdateChatBlob",this.onClientUpdateChatBlob),N.a.removeListener("clientUpdateUserBlob",this.onClientUpdateUserBlob)}},{key:"render",value:function(){var e=this.state,t=(e.width,e.height,e.file);if(!t)return null;var a=N.a.getBlob(t.id)||t.blob,n=N.a.getBlobUrl(a);return h.a.createElement("div",{className:"media-viewer-content"},h.a.createElement("img",{className:"media-viewer-content-image",src:n,alt:"",onClick:this.handleContentClick}),h.a.createElement(U.a,{file:t}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.chatId,n=e.photo;return a!==t.prevChatId||n!==t.prevPhoto?{prevChatId:a,prevPhoto:n,width:P.O,height:P.O,file:n.big}:null}}]),t}(h.a.Component)),F=a(404),S=a(436),L=(a(477),function(e){function t(e){return Object(o.a)(this,t),Object(d.a)(this,Object(c.a)(t).call(this,e))}return Object(s.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.date;return h.a.createElement("div",{className:"media-viewer-control"},h.a.createElement("div",{className:"media-viewer-control-wrapper"},h.a.createElement(F.a,{chatId:t,showSavedMessages:!1}),h.a.createElement("div",{className:"media-viewer-control-content"},h.a.createElement("div",{className:"media-viewer-row"},h.a.createElement(S.a,{chatId:t})),a&&h.a.createElement("div",{className:"media-viewer-row message-meta"},h.a.createElement("span",{className:"message-date"},a)))))}}]),t}(h.a.Component)),D=a(399),z=a(393),H=a(16),_=a(69),A=a(2),V={padding:20,color:"white",transform:"scaleX(-1)"},W={padding:20,color:"white"},K={padding:35,color:"white"},Q=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(d.a)(this,Object(c.a)(t).call(this,e))).onKeyDown=function(e){if(27===e.keyCode){if(a.state.deleteConfirmationOpened)return;a.handleClose()}else 39===e.keyCode?a.handlePrevious():37===e.keyCode&&a.handleNext()},a.loadHistory=Object(r.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.chatId,Object(B.Q)(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,A.a.send({"@type":"getUserProfilePhotos",user_id:Object(B.v)(t),offset:0,limit:100});case 5:n=e.sent,a.history=n.photos,a.firstSliceLoaded=0===n.photos.length,0,a.setState({currentIndex:0,hasNextMedia:a.hasNextMedia(0),hasPreviousMedia:a.hasPreviousMedia(0),totalCount:n.total_count}),Object(z.v)(t,0,a.history);case 11:case"end":return e.stop()}},e)})),a.handleClose=function(){H.a.setProfileMediaViewerContent(null)},a.handleSave=function(){var e=a.props.chatId,t=a.state,n=t.currentIndex,i=t.totalCount,r=_.a.get(e);if(r){var o=-1;i&&(o=n);var l=o>0&&o<a.history.length?Object(D.a)(a.history[o]):Object(B.F)(e);if(l&&l.big){var d=N.a.get(l.big.id)||l.big;d&&Object(z.w)(d,d.id+".jpg",r,function(){return N.a.updateChatPhotoBlob(e,d.id)})}}},a.handleForward=function(){var e=a.props.chatId;if(Object(B.Q)(e)){var t=a.state,n=t.currentIndex,i=-1;if(t.totalCount&&(i=n),!(i<0||i>=a.history.length)){var r=Object(D.a)(a.history[i]);if(r){var o=r.big;if(o=N.a.get(o.id)||o){var l={"@type":"photoSize",type:"c",photo:o,width:640,height:640};A.a.clientUpdate({"@type":"clientUpdateForward",info:{photoSize:l}})}}}}},a.handleDelete=function(){var e=a.props,t=e.chatId,n=(e.messageId,a.state),i=n.currentIndex,r=-1;n.totalCount&&(r=i);var o=r>0&&r<a.history.length?Object(D.a)(a.history[r]):Object(B.F)(t);if(o){var l=o.big;if(l=N.a.get(l.id)||l){var d=N.a.getReadWriteStore();N.a.deleteLocalFile(d,l)}}},a.hasPreviousMedia=function(e){return-1!==e&&e+1<a.history.length},a.handlePrevious=function(e){e&&e.stopPropagation();var t=a.state.currentIndex+1;return a.loadMedia(t,function(){t===a.history.length-1&&a.loadPrevious()})},a.loadPrevious=Object(r.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}},e)})),a.hasNextMedia=function(e){return-1!==e&&e-1>=0},a.handleNext=function(e){e&&e.stopPropagation();var t=a.state.currentIndex-1;return a.loadMedia(t,function(){0===t&&a.loadNext()})},a.loadNext=Object(r.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}},e)})),a.loadMedia=function(e,t){if(e<0)return!1;if(e>=a.history.length)return!1;a.setState({currentIndex:e,hasNextMedia:a.hasNextMedia(e),hasPreviousMedia:a.hasPreviousMedia(e)},t);var n=a.props.chatId;return Object(z.v)(n,e,a.history),!0},a.history=[];var n=a.props,l=n.chatId,s=n.fileId;return a.state={prevChatId:l,prevFileId:s,currentIndex:0,hasNextMedia:!1,hasPreviousMedia:!1,deleteConfirmationOpened:!1},a}return Object(s.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,i=a.messageId,r=this.state,o=r.currentFileId,l=r.hasPreviousMedia,d=r.hasNextMedia,c=r.firstSliceLoaded,s=r.totalCount,u=r.deleteConfirmationOpened;return e.chatId!==n||(e.messageId!==i||(t.currentFileId!==o||(t.hasPrevousMedia!==l||(t.hasNextMedia!==d||(t.firstSliceLoaded!==c||(t.totalCount!==s||t.deleteConfirmationOpened!==u))))))}},{key:"componentDidMount",value:function(){var e=this.props.chatId,t=Object(B.F)(e);Object(z.p)(e,[t]),this.loadHistory(),document.addEventListener("keydown",this.onKeyDown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown,!1)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t,n=this.state,i=n.currentIndex,r=n.hasNextMedia,o=n.hasPreviousMedia,l=(n.firstSliceLoaded,n.totalCount),d=(n.deleteConfirmationOpened,n.deleteForAll,-1);l&&(d=i);var c=d>=0&&d<this.history.length,s=c?Object(D.a)(this.history[d]):Object(B.F)(t),u=c?this.history[d]:null,p=s.big;return h.a.createElement("div",{className:"media-viewer"},null,h.a.createElement("div",{className:"media-viewer-wrapper",onClick:this.handlePrevious},h.a.createElement("div",{className:"media-viewer-left-column"},h.a.createElement("div",{className:"media-viewer-button-placeholder"}),h.a.createElement(k.a,{disabled:!r,grow:!0,onClick:this.handleNext},h.a.createElement(g.a,{fontSize:"large",style:K}))),h.a.createElement("div",{className:"media-viewer-content-column"},h.a.createElement(x,{chatId:t,photo:s,onClick:this.handlePrevious})),h.a.createElement("div",{className:"media-viewer-right-column"},h.a.createElement(k.a,{onClick:this.handleClose},h.a.createElement(f.a,{fontSize:"large",style:K})),h.a.createElement(k.a,{disabled:!o,grow:!0,onClick:this.handlePrevious},h.a.createElement(b.a,{fontSize:"large",style:K})))),h.a.createElement("div",{className:"media-viewer-footer"},h.a.createElement(L,{chatId:t,date:Object(D.b)(u)}),h.a.createElement(E.a,{title:a("AttachPhoto"),subtitle:l&&d>=0?"".concat(d+1," of ").concat(l):null}),h.a.createElement(I.a,{title:a("Save"),fileId:p.id,onClick:this.handleSave}),Object(B.Q)(t)&&h.a.createElement(M.a,{title:a("Forward"),disabled:!c,onClick:this.handleForward},h.a.createElement(j.a,{style:V})),h.a.createElement(M.a,{title:a("Delete"),disabled:!0,onClick:this.handleDelete},h.a.createElement(y.a,{style:W}))))}}]),t}(h.a.Component);t.default=Object(p.c)()(Q)}}]);
//# sourceMappingURL=12.64436f7f.chunk.js.map