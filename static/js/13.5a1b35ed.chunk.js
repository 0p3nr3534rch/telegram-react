(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{418:function(e,t,a){"use strict";var n=a(447),r="Copy to clipboard: #{key}, Enter";e.exports=function(e,t){var a,s,i,c,o,l,d=!1;t||(t={}),a=t.debug||!1;try{if(i=n(),c=document.createRange(),o=document.getSelection(),(l=document.createElement("span")).textContent=e,l.style.all="unset",l.style.position="fixed",l.style.top=0,l.style.clip="rect(0, 0, 0, 0)",l.style.whiteSpace="pre",l.style.webkitUserSelect="text",l.style.MozUserSelect="text",l.style.msUserSelect="text",l.style.userSelect="text",document.body.appendChild(l),c.selectNode(l),o.addRange(c),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");d=!0}catch(u){a&&console.error("unable to copy using execCommand: ",u),a&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",e),d=!0}catch(u){a&&console.error("unable to copy using clipboardData: ",u),a&&console.error("falling back to prompt"),s=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:r),window.prompt(s,e)}}finally{o&&("function"==typeof o.removeRange?o.removeRange(c):o.removeAllRanges()),l&&document.body.removeChild(l),i()}return d}},447:function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,a=[],n=0;n<e.rangeCount;n++)a.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||a.forEach(function(t){e.addRange(t)}),t&&t.focus()}}},456:function(e,t,a){"use strict";a.d(t,"a",function(){return r}),a.d(t,"b",function(){return i});var n=null;function r(e){if(!e)return null;if(!e.length)return null;n=n||new Map([["q","\u0439"],["w","\u0446"],["e","\u0443"],["r","\u043a"],["t","\u0435"],["y","\u043d"],["u","\u0433"],["i","\u0448"],["o","\u0449"],["p","\u0437"],["[","\u0445"],["]","\u044a"],["a","\u0444"],["s","\u044b"],["d","\u0432"],["f","\u0430"],["g","\u043f"],["h","\u0440"],["j","\u043e"],["k","\u043b"],["l","\u0434"],[";","\u0436"],["'","\u044d"],["\\","\u0451"],["z","\u044f"],["x","\u0447"],["c","\u0441"],["v","\u043c"],["b","\u0438"],["n","\u0442"],["m","\u044c"],[",","\u0431"],[".","\u044e"]]);for(var t="",a=0;a<e.length;a++){if(!n.has(e[a]))return null;t+=n.get(e[a])}return""===t?null:t}var s=null;function i(e){if(!e)return null;if(!e.length)return null;s=s||new Map([["\u0439","q"],["\u0446","w"],["\u0443","e"],["\u043a","r"],["\u0435","t"],["\u043d","y"],["\u0433","u"],["\u0448","i"],["\u0449","o"],["\u0437","p"],["\u0445","["],["\u044a","]"],["\u0444","a"],["\u044b","s"],["\u0432","d"],["\u0430","f"],["\u043f","g"],["\u0440","h"],["\u043e","j"],["\u043b","k"],["\u0434","l"],["\u0436",";"],["\u044d","'"],["\u0451","\\"],["\u044f","z"],["\u0447","x"],["\u0441","c"],["\u043c","v"],["\u0438","b"],["\u0442","n"],["\u044c","m"],["\u0431",","],["\u044e","."]]);for(var t="",a=0;a<e.length;a++){if(!s.has(e[a]))return null;t+=s.get(e[a])}return""===t?null:t}},629:function(e,t,a){},630:function(e,t,a){},728:function(e,t,a){"use strict";a.r(t);var n=a(14),r=a.n(n),s=a(55),i=a(24),c=a(7),o=a(10),l=a(12),d=a(11),u=a(13),h=a(395),p=a(0),f=a.n(p),g=a(418),m=a.n(g),b=a(8),y=a.n(b),v=a(77),w=a(6),_=a.n(w),C=a(53),k=a(125),x=a(32),S=a.n(x),M=a(120),E=a.n(M),T=a(78),O=a.n(T),j=a(81),L=a.n(j),R=a(79),I=a.n(R),P=a(402),U=a.n(P),D=a(404),N=a(391),A=(a(629),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.chatId,n=e.selected,r=e.onSelect,s=Object(N.n)(a,!0);return f.a.createElement("div",{className:y()("forward-target-chat",{"forward-target-chat-selected":n}),onClick:r},f.a.createElement("div",{className:"forward-target-chat-tile"},f.a.createElement("div",{className:"forward-target-chat-tile-wrapper"},f.a.createElement(D.a,{chatId:a,showSavedMessages:!0})),n&&f.a.createElement("div",{className:y()("forward-target-chat-selection",t.border)}),f.a.createElement("div",{className:y()("forward-target-chat-mark",n?t.markSelected:t.markUnselected)}),f.a.createElement("div",{className:"forward-target-chat-mark-icon"})),f.a.createElement("div",{className:"forward-target-chat-title"},s))}}]),t}(f.a.Component)),z=_()(function(e){return{border:{borderColor:e.palette.primary.main},markSelected:{boxShadow:"inset 0 0 0 10px "+e.palette.primary.main,border:"2px solid "+e.palette.background.paper},markUnselected:{boxShadow:"inset 0 0 0 0 "+e.palette.primary.main,border:"2px solid transparent"}}},{withTheme:!0})(A),H=a(393),K=a(456),F=a(398),q=a(27),J=a(16),W=a(392),X=a(394),B=a(45),G=a(2),Q=(a(630),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).loadContent=Object(i.a)(r.a.mark(function e(){var t,n,i,c,o,l,d,u;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.getPublicMessageLink(),t=[],n=G.a.send({"@type":"getChats",offset_order:"9223372036854775807",offset_chat_id:0,limit:100}),t.push(n),i=G.a.send({"@type":"createPrivateChat",user_id:B.a.getMyId(),force:!0}),t.push(i),e.next=8,Promise.all(t.map(function(e){return e.catch(function(e){return null})}));case 8:c=e.sent,o=Object(s.a)(c,2),l=o[0],d=o[1],a.setState({chatIds:l.chat_ids,savedMessages:d}),u=W.a.getStore(),Object(H.l)(u,l.chat_ids);case 15:case"end":return e.stop()}},e)})),a.getPublicMessageLink=Object(i.a)(r.a.mark(function e(){var t,n,s,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props,n=t.chatId,s=t.messageIds,n){e.next=3;break}return e.abrupt("return");case 3:if(s){e.next=5;break}return e.abrupt("return");case 5:if(!(s.length>1)){e.next=7;break}return e.abrupt("return");case 7:if(Object(N.R)(n)){e.next=9;break}return e.abrupt("return");case 9:if(Object(N.w)(n)){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,G.a.send({"@type":"getPublicMessageLink",chat_id:n,message_id:s[0],for_album:!1});case 13:i=e.sent,a.setState({publicMessageLink:i});case 15:case"end":return e.stop()}},e)})),a.handleClose=function(){G.a.clientUpdate({"@type":"clientUpdateForward",info:null})},a.handleCopyLink=function(){var e=a.props.t,t=a.state.publicMessageLink;if(t&&t.link){var n="copy_link_".concat(t.link),r=e("LinkCopied");m()(t.link),a.handleScheduledAction(n,r,null)}},a.handleScheduledAction=function(e,t,n){if(e){var r=a.props,s=r.enqueueSnackbar,i=r.classes;if(s){J.a.addScheduledAction(e,q.p+300,n)&&s(t,{autoHideDuration:q.p,action:[f.a.createElement(E.a,{key:"close","aria-label":"Close",color:"inherit",className:i.close,onClick:function(){return J.a.removeScheduledAction(e)}},f.a.createElement(U.a,null))]})}}},a.getForwardPhotoSize=function(e,t){if(1!==t.length)return null;var a=X.a.get(e,t[0]);if(!a)return null;var n=a.can_be_forwarded,r=a.content;if(!n&&"messageChatChangePhoto"===r["@type"]){var s=r.photo;if(!s)return null;var i=s.sizes;if(i&&i.length)return i[i.length-1]}return null},a.handleSend=function(){a.handleClose();var e=a.props,t=e.chatId,n=e.messageIds,r=e.photoSize,s=e.link;if(t||n||n||r||s){var i=a.getInnerText(a.messageRef.current);a.targetChats.forEach(function(e){if(s)return i&&G.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:i,entities:null},disable_web_page_preview:!0,clear_draft:!1}}),void G.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:s,entities:null},disable_web_page_preview:!0,clear_draft:!1}});var c=r||a.getForwardPhotoSize(t,n);if(c){var o=c.width,l=c.height,d=c.photo;G.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessagePhoto",photo:{"@type":"inputFileId",id:d.id},thumbnail:null,added_sticker_file_ids:[],width:o,height:l,caption:{"@type":"formattedText",text:i,entities:null},ttl:0}})}else i&&G.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:i,entities:null},disable_web_page_preview:!0,clear_draft:!1}}),G.a.send({"@type":"forwardMessages",chat_id:e,from_chat_id:t,message_ids:n,disable_notifications:!1,from_background:!1,as_album:!1})})}},a.handleChangeSelection=function(e){a.targetChats.has(e)?a.targetChats.delete(e):a.targetChats.set(e,e),console.log(a.targetChats),a.forceUpdate()},a.getInnerText=function(e){var t=e.innerText,a=e.innerHTML;return t&&"\n"===t&&a&&("<br>"===a||"<div><br></div>"===a)&&(e.innerHTML=""),t},a.handleSearchKeyDown=function(e){13===e.keyCode&&e.preventDefault()},a.handleSearchKeyUp=function(){var e=a.state,t=e.chatIds,n=e.savedMessages,r=a.searchRef.current.innerHTML;!r||"<br>"!==r&&"<div><br></div>"!==r||(a.searchRef.current.innerHTML="");var s=a.getInnerText(a.searchRef.current).trim();if(s){var i=Object(K.b)(s),c=Object(K.a)(s),o=(n?[n.id].concat(t.filter(function(e){return e!==n.id})).filter(function(e){return Object(N.e)(e)}):t).filter(function(e){return a.hasSearchText(e,s)||i&&a.hasSearchText(e,i)||c&&a.hasSearchText(e,c)});a.setState({searchText:s,searchResults:o})}else a.setState({searchText:null,searchResults:[]})},a.handleSearchPaste=function(e){var t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertHTML",!1,t))},a.handleMessageKeyUp=function(){var e=a.messageRef.current.innerHTML;!e||"<br>"!==e&&"<div><br></div>"!==e||(a.messageRef.current.innerHTML="")},a.handleMessagePaste=function(e){var t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertHTML",!1,t))},a.hasSearchText=function(e,t){var n=a.props.t,r=a.state.savedMessages;if(r&&e===r.id&&-1!==(Object(N.q)(e,!0,n)||"").toLocaleLowerCase().indexOf(t.toLowerCase()))return!0;return-1!==(Object(N.q)(e,!1,n)||"").toLocaleLowerCase().indexOf(t.toLowerCase())||-1!==(Object(N.w)(e)||"").toLocaleLowerCase().indexOf(t.toLowerCase())},a.setSearchFocus=function(){setTimeout(function(){a.searchRef.current&&a.searchRef.current.focus()},100)},a.state={chatIds:[],savedMessages:null},a.searchRef=f.a.createRef(),a.messageRef=f.a.createRef(),a.targetChats=new Map,a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.loadContent(),this.setSearchFocus()}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.t,r=this.state,s=r.chatIds,i=r.searchText,c=r.searchResults,o=r.savedMessages,l=r.publicMessageLink,d=(o?[o.id].concat(s.filter(function(e){return e!==o.id})).filter(function(e){return Object(N.e)(e)}):s).map(function(t){return f.a.createElement(z,{key:t,chatId:t,selected:e.targetChats.has(t),onSelect:function(){return e.handleChangeSelection(t)}})}),u=(c||[]).map(function(t){return f.a.createElement(z,{key:t,chatId:t,selected:e.targetChats.has(t),onSelect:function(){return e.handleChangeSelection(t)}})});return f.a.createElement(O.a,{open:!0,onClose:this.handleClose,"aria-labelledby":"forward-dialog-title","aria-describedby":"forward-dialog-description",className:a.dialog},f.a.createElement(I.a,{id:"forward-dialog-title"},n("ShareSendTo")),f.a.createElement("div",{ref:this.searchRef,id:"forward-dialog-search",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:n("Search"),onKeyDown:this.handleSearchKeyDown,onKeyUp:this.handleSearchKeyUp,onPaste:this.handleSearchPaste}),f.a.createElement("div",{className:y()(a.borderColor,"forward-dialog-content")},f.a.createElement("div",{className:"forward-dialog-list"},d),i&&f.a.createElement("div",{className:y()(a.searchList,"forward-dialog-search-list")},u)),this.targetChats.size>0&&f.a.createElement("div",{ref:this.messageRef,id:"forward-dialog-message",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:n("ShareComment"),onKeyUp:this.handleMessageKeyUp,onPaste:this.handleMessagePaste}),f.a.createElement(L.a,null,f.a.createElement(S.a,{onClick:this.handleClose,color:"primary"},n("Cancel")),this.targetChats.size>0&&f.a.createElement(S.a,{onClick:this.handleSend,color:"primary",autoFocus:!0},n("Send")),!this.targetChats.size&&l&&f.a.createElement(S.a,{onClick:this.handleCopyLink,color:"primary"},n("CopyLink"))))}}]),t}(f.a.Component)),V=Object(v.a)(_()(function(e){return Object(h.a)({close:{padding:e.spacing.unit/2},dialog:{color:e.palette.text.primary},dialogContent:{padding:0,display:"flex",position:"relative"},searchList:{background:e.palette.background.paper}},Object(F.b)(e))},{withTheme:!0}),Object(C.c)(),k.withSnackbar);t.default=V(Q)}}]);
//# sourceMappingURL=13.5a1b35ed.chunk.js.map